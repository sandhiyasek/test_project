DISTRICT_NAME_COUNT = select count(*) from shdrc_dwh."District_Master" where "State_Name"='Tamil Nadu'
ACCESS_RESTRICTED_DISTRICT_NAME_COUNT=select count(Distinct Dist."District_Name") from shdrc_dwh."Institution_Master_Dim" Inst JOIN shdrc_dwh."Location_Master" Loc ON Loc."Location_Id" = Inst."Location_Id" JOIN shdrc_dwh."District_Master" Dist ON Loc."District_Id" = Dist."District_Id" LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ? ) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "Location_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Block' AND "User_Master"."User_Name" = ? ) "User_Restrict_Block" ON Loc."Location_Id" = "User_Restrict_Block"."Location_Id"  LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ? ) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  Dist."State_Name"='Tamil Nadu' and ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR "User_Restrict_Block"."Location_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ? ));
DISTRICT_NAME=select Distinct  Dist."District_Id",Dist."District_Name" from shdrc_dwh."Institution_Master_Dim" Inst JOIN shdrc_dwh."Location_Master" Loc ON Loc."Location_Id" = Inst."Location_Id" JOIN shdrc_dwh."District_Master" Dist ON Loc."District_Id" = Dist."District_Id" LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ? ) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "Location_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Block' AND "User_Master"."User_Name" = ? ) "User_Restrict_Block" ON Loc."Location_Id" = "User_Restrict_Block"."Location_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ? ) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  Dist."State_Name"='Tamil Nadu' and ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR "User_Restrict_Block"."Location_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ? )) order by Dist."District_Name"  asc;
#SELECT_DIRECTORATE_MASTER=select "Directorate_Id","Directorate_Name" from shdrc_dwh."Directorate_Master_Dim" where "Directorate_Name" in (?)  order by "Directorate_Name" asc;
SELECT_DIRECTORATE_SERVLET=select "Directorate_Id","Directorate_Controller_Name" from shdrc_data."Directorate_Controller";
SELECT_DEMOGRAPHIC_MASTER = select "Demographic_Id","Gender","Age_Group","Social" from shdrc_dwh."Demographic_Dim" order by "Financial" asc, "Gender" desc,"Age_Group" asc
#GENERAL_CATEGORY_LIST_BY_FREQUENCY = select distinct "General_Category" from shdrc_dwh."Vw_UDSM" where "Directorate_Id"=? and "Indicator_Frequency" = ? order by "General_Category" asc;
#INDICATOR_LIST = select "Indicator_Id","General_Id","Indicator_Name","General_Type","General_Name","General_SubCategory",null,"Is_Demography",null,null,null from shdrc_dwh."Vw_UDSM" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=? and "Is_Demography"=? order by "General_SubCategory","Indicator_Name","General_Type","General_Name" asc;
#CLASSIFICATION_LIST=select distinct "General_Category" from shdrc_dwh."Vw_UDSM" where "Directorate_Id" =? order by "General_Category" asc; 
GET_USER_TIER= select tier."Tier_Cd" from shdrc_dwh."User_Master" usr join shdrc_dwh."User_Tier_Master" tier on usr."Tier"=tier."Tier_Id" where "User_Name"=?;
GENDER_AGEGROUP=select  Val."Gender",Val."Age_Group",Val."Age_In_Days",Val."Social",null,null,null from shdrc_dwh."Demographic_Ind" Ind JOIN shdrc_dwh."Demographic_Ind_Val" Val ON Ind."Demographic_Ind_Id" = Val."Demographic_Ind_Id" where "Indicator_Id" = ? order by Val."Gender","Age_Group"
DEMOGRAPHIC_STATUS=SELECT "Gender", "Age_Group", "Age_In_Days", "Social" FROM shdrc_dwh."Demographic_Ind" where "Indicator_Id"=?
IS_DEMOGRAPHIC=select distinct "Is_Demography" from shdrc_dwh."Vw_UDSM" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=? order by "Is_Demography" desc;
INSERT_MESSAGE_ALERT=insert into shdrc_data."Alert_Message" ("Directorate_Id","Send_Sms","Message","Message_Type","Message_Header","Added_On","Added_By") values(?,?,?,?,?,?,?);
GET_USER_ACCESS_LEVEL=select  "User_Role_Assoc_Name" from shdrc_dwh."User_Master" usrMast JOIN shdrc_dwh."User_Role_Assoc" roleassoc ON usrMast."User_Id" = roleassoc."User_Id" where usrMast."User_Name"=?
INSERT_USER_AUDIT_LOG=INSERT INTO shdrc_dwh."User_Login_Audit"("User_Name","Login_Time", "IP_Address") VALUES (?, ?, ?);
DIRECTORATE_LIST_BY_ID=SELECT * FROM  shdrc_dwh."Directorate_Master_Dim" WHERE "Directorate_Id" =?

#File Upload 
ADD_FILE_UPLOAD_AUDIT=insert into shdrc_data."File_Upload_Audit" ("Directorate_Id","District_Id","Institution_Id","File_Name","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_By") values(?,?,?,?,?,?,?,?,?,?,?);
ADD_FILE_UPLOAD_AUDIT_DFS=insert into shdrc_data."File_Upload_Audit" ("Directorate_Id","HUD_Id","Location_Id","File_Name","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_By") values(?,?,?,?,?,?,?,?,?,?,?);
ADD_FILE_UPLOAD_AUDIT_MA=insert into shdrc_data."File_Upload_Audit" ("Directorate_Id","HUD_Id","Location_Id","File_Name","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_By") values(?,?,?,?,?,?,?,?,?,?,?);
FILE_LIST_BASED_ON_FREQUENCY=SELECT "File_Id","File_Name", "File_Extension" FROM shdrc_dwh."File_Master" filemaster LEFT JOIN (select UR."Role_Id" from shdrc_dwh."User_Roles" UR join shdrc_dwh."User_Role_Assoc" URA on URA."Role_Id" = UR."Role_Id" join shdrc_dwh."User_Master" UM on UM."User_Id" = URA."User_Id" and UM."User_Name" = ? ) "User_Restrict_Zone" ON filemaster."Role_Id" = "User_Restrict_Zone"."Role_Id" where "Directorate_Id"=? and "Frequency"=? and "Is_Upload_Required"='Y' and ("User_Restrict_Zone"."Role_Id" IS NOT NULL OR NOT EXISTS ( select UR."Role_Id" from shdrc_dwh."User_Roles" UR join shdrc_dwh."User_Role_Assoc" URA on URA."Role_Id" = UR."Role_Id" join shdrc_dwh."User_Master" UM on UM."User_Id" = URA."User_Id" and UM."User_Name" = ?)) order by "File_Name" asc;
FILE_AUDIT_DAILY_RECORDS_COUNT=select count(*) from shdrc_data."File_Upload_Audit" where "Directorate_Id"=? and "District_Id"=? and "Institution_Id"=? and "Frequency"=? and "File_Name" like ? and "Transaction_Date"=?
FILE_AUDIT_WEEKLY_RECORDS_COUNT=select count(*) from shdrc_data."File_Upload_Audit" where "Directorate_Id"=? and "District_Id"=? and "Institution_Id"=? and "Frequency"=? and "File_Name" like ? and "Transaction_Week"=? and "Transaction_Month"=? and "Transaction_Year"=?
FILE_AUDIT_MONTHLY_RECORDS_COUNT=select count(*) from shdrc_data."File_Upload_Audit" where "Directorate_Id"=? and "District_Id"=? and "Institution_Id"=? and "Frequency"=? and "File_Name" like ? and "Transaction_Month"=? and "Transaction_Year"=?
FILE_AUDIT_QUARTERLY_RECORDS_COUNT=select count(*) from shdrc_data."File_Upload_Audit" where "Directorate_Id"=? and "District_Id"=? and "Institution_Id"=? and "Frequency"=? and "File_Name" like ? and "Transaction_Quarter"=? and "Transaction_Year"=?
FILE_AUDIT_YEARLY_RECORDS_COUNT=select count(*) from shdrc_data."File_Upload_Audit" where "Directorate_Id"=? and "District_Id"=? and "Institution_Id"=? and "Frequency"=? and "File_Name" like ? and "Transaction_Year"=?
DME_FILE_LIST_BASED_ON_FREQUENCY=SELECT "File_Id","File_Name", "File_Extension" FROM shdrc_dwh."File_Master" filemaster where "Directorate_Id"=? and "Frequency"=? and "Is_Upload_Required"='Y' order by "File_Name" asc
FILE_AUDIT_QUARTERLY_HUD_RECORDS_COUNT=select count(*) from shdrc_data."File_Upload_Audit" where "Directorate_Id"=? and "HUD_Id"=? and "Location_Id"=? and "Frequency"=? and "File_Name" like ? and "Transaction_Quarter"=? and "Transaction_Year"=?

<!--SMS Alert -->
SELECT_MOBILE_NO = select "User_Id","Mobile_Number" from shdrc_data."User" 
GET_SMS_INFO = select alert."SMS_log_Key",alert."Directorate_Name",alert."Drill_Down_Level_Name",alert."Indicator_Name",alert."Ind_Value",alert."Red_Value_Inst",alert."Threshold_Comparator",alert."Mobile_No" from shdrc_dwh."SMS_log" alert where "Directorate_Id"=? and "Alerted"='N'
UPDATE_SMS_ALERT = update shdrc_dwh."SMS_log" set "Alerted"='Y' where "SMS_log_Key"=?
GET_CRON_TRIGER_SMS_INFO=select alert."SMS_log_Key",alert."Directorate_Name",alert."Drill_Down_Level_Name",alert."Indicator_Name",alert."Ind_Value",alert."Red_Value",alert."Threshold_Comparator",alert."Mobile_No","Hierarchy_Name","Time_Month_Name","Time_Year" from shdrc_dwh."SMS_log" alert where "Alerted"='N' and "SMS_Alert"='Y'

<!--Change Password-->
SELECT_USER_PWD = select usermas."User_Id",usermas."Upass",orggroup."Org_Name" from shdrc_dwh."User_Master" usermas JOIN shdrc_dwh."User_Tier_Master" tier ON usermas."Tier"=tier."Tier_Id" JOIN shdrc_dwh."User_Org_Group" orggroup ON tier."OG_Id"=orggroup."OG_Id" where "User_Name"=?;
UPDATE_USER_PWD = update shdrc_dwh."User_Master" set "Prev_Pass"=?,"Upass"=?,"Updated_On"=? where "User_Name"=?

<!--Modify User Details-->
SELECT_USER_DETAILS = select "Ufname","Ulname","Upass","Email","Mobile" from shdrc_dwh."User_Master" where "User_Name"=?
UPDATE_USER_DETAILS = update shdrc_dwh."User_Master" set "Ufname"=?,"Ulname"=?,"Email"=?,"Mobile"=?,"Updated_On"=? where "User_Name"=?

<!--Access Restriction-->
SELECT_AUTHORIZE_LIST = select "User_Id","User_Name" from shdrc_dwh."User_Master" where "Directorate_Id"=? AND "User_Name" like '%de%';
SELECT_INSTITUTION_LIST = select Inst."Institution_Id",Inst."Institution_Name" from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"=? and Directorate_Id=? and Loc."District_Id"=? 
UPDATE_USER_ACCESS = 

#Notification Message
GET_NEWS_INFO=select "Message_Header","Message","Added_By", "Added_On" from shdrc_data."Alert_Message" alertMsg where alertMsg."Message_Id"=?


<!--MA Directorate -->
MA_DAILY_RECORDS =  select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."MA_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "Region_Name"=? and "HUD_Id"=? and "Location_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Date"=? order by Gen."General_SubCategory",Gen."Gen_Order", Mast."Ind_Order" asc;
MA_WEEKLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."MA_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "Region_Name"=? and "HUD_Id"=? and "Location_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Week"=? and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Gen."Gen_Order", Mast."Ind_Order" asc;
MA_MONTHLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."MA_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "Region_Name"=? and "HUD_Id"=? and "Location_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Gen."Gen_Order", Mast."Ind_Order" asc;
MA_QUARTERLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."MA_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "Region_Name"=? and "HUD_Id"=? and "Location_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Quarter"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Gen."Gen_Order", Mast."Ind_Order" asc;
MA_YEARLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."MA_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "Region_Name"=? and "HUD_Id"=? and "Location_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Year"=? order by Gen."General_SubCategory",Gen."Gen_Order", Mast."Ind_Order" asc;
INSERT_MA_DIRECTORATE = insert into shdrc_data."MA_Transaction" ("Directorate_Id","Region_Name","Data_Entry_Level", "Location_Id","Institution_Id","General_Id","General_Type","General_Name","General_SubCategory","Indicator_Id","Indicator_Name","Is_Character","Indicator_Value","Indicator_Value1","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_On","Added_By","HUD_Id") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);	
UPDATE_MA_DIRECTORATE = update shdrc_data."MA_Transaction"  set "ETL_Process_Status" ='M',"Indicator_Value"=? ,"Indicator_Value1"=?,"Updated_On"=? where "Transaction_Key"=?;
SELECT_CORPORATION_MUNICIPALITY = select distinct  Loc."Location_Id",Loc."Block_Name",Hud."HUD_Id" from shdrc_dwh."Location_Master" Loc JOIN shdrc_dwh."HUD_Master" Hud ON Loc."HUD_Id" = Hud."HUD_Id" and Hud."Active"=1 and Loc."Active"=1 and Hud."HUD_Type" in ('Corporation','Region') and  Hud."HUD_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "HUD_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Corporation' AND "User_Master"."User_Name" = ?) "User_Restrict_HUD" ON Loc."HUD_Id" = "User_Restrict_HUD"."HUD_Id" LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "Location_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Municipality' AND "User_Master"."User_Name" = ?) "User_Restrict_Block" ON Loc."Location_Id" = "User_Restrict_Block"."Location_Id" WHERE ("User_Restrict_HUD"."HUD_Id" IS NOT NULL OR "User_Restrict_Block"."Location_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Location_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ? )) order by Loc."Block_Name"  asc;
MA_REGION_INSTITUTION=select Inst."Institution_Id",Inst."Institution_Name" from shdrc_dwh."Institution_Master_Dim" Inst JOIN shdrc_dwh."Location_Master" Loc ON Loc."Location_Id" = Inst."Location_Id" JOIN shdrc_dwh."District_Master" Dist ON Loc."District_Id" = Dist."District_Id" where Inst."Active"=1 and  Loc."Active"=1 and Dist."Active"=1 and Inst."Institution_Level"='NUHM' and  Loc."Location_Id"=? 
MA_CORPORATION_INSTITUTION=select Inst."Institution_Id",Inst."Institution_Name" from shdrc_dwh."Institution_Master_Dim" Inst JOIN shdrc_dwh."Location_Master" Loc ON Loc."Location_Id" = Inst."Location_Id" JOIN shdrc_dwh."HUD_Master" HUD ON Loc."HUD_Id" = HUD."HUD_Id" where Inst."Active"=1 and  Loc."Active"=1 and HUD."Active"=1  and Inst."Institution_Level"='NUHM' and HUD."HUD_Id"=?
MA_REGION_NAME= select distinct  Hud."HUD_Id",Hud."HUD_Name" from shdrc_dwh."Location_Master" Loc JOIN shdrc_dwh."HUD_Master" Hud ON Loc."HUD_Id" = Hud."HUD_Id" and Hud."Active"=1 and Loc."Active"=1 and Hud."HUD_Type" in ('Corporation','Region') LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "Location_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Corporation' AND "User_Master"."User_Name" = ?) "User_Restrict_HUD" ON Loc."Location_Id" = "User_Restrict_HUD"."Location_Id" LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "Location_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Municipality' AND "User_Master"."User_Name" = ?) "User_Restrict_Block" ON Loc."Location_Id" = "User_Restrict_Block"."Location_Id" WHERE ("User_Restrict_HUD"."Location_Id" IS NOT NULL OR "User_Restrict_Block"."Location_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id"  FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ? )) order by Hud."HUD_Name"  asc;
MA_DISTRICT_NAME=select distinct Dist."District_Id",Dist."District_Name"  from shdrc_dwh."HUD_Master" Hud JOIN shdrc_dwh."Location_Master" Loc ON Loc."HUD_Id" = Hud."HUD_Id" JOIN shdrc_dwh."District_Master" Dist ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Inst."Location_Id" = Loc."Location_Id" and Hud."HUD_Type" in ('Corporation','Region') and Hud."HUD_Name"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ? ) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ? ) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" =  Inst."Institution_Id" WHERE  Loc."Active"=1 and HUD."Active"=1 and  Inst."Active"=1 and Dist."State_Name"='Tamil Nadu' and (Hud."HUD_Name" like '%Region%' or  Hud."HUD_Name" like '%Corporation%') AND ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ? )) order by Dist."District_Name"  asc;
MA_GENERAL_CATEGORY_LIST_BY_FREQUENCY = select distinct "General_Category" from shdrc_dwh."Vw_UDSM_MA" where "Directorate_Id"=? and "Indicator_Frequency" = ? and "Ind_Hierarchy"=? order by "General_Category" asc;
MA_INDICATOR_LIST = select "Indicator_Id","General_Id","Indicator_Name","General_Type","General_Name","General_SubCategory",null,"Is_Demography",null,null,"Is_Character",null from shdrc_dwh."Vw_UDSM_MA" where "Directorate_Id"=?  and "General_Category"=? and "Indicator_Frequency"=? and "Is_Demography"=? and "Ind_Hierarchy"=? order by "General_SubCategory","Gen_Order","Ind_Order" asc;
MA_CLASSIFICATION_LIST=select distinct "General_Category" from shdrc_dwh."Vw_UDSM_MA" where "Directorate_Id" =? order by "General_Category" asc;
IS_MA_DEMOGRAPHIC=select distinct "Is_Demography" from shdrc_dwh."Vw_UDSM_MA" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=?;


<!--DPH Directorate -->
DPH_DAILY_RECORDS =  select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DPH_Transaction" Trans, shdrc_dph."Indicator_Master_Dim" Mast,shdrc_dph."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Type"=?  and "Institution_Id"=? and Mast."Indicator_Category"=? and "Program"=? and "Frequency"=?  and "Transaction_Date"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
DPH_WEEKLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DPH_Transaction" Trans, shdrc_dph."Indicator_Master_Dim" Mast,shdrc_dph."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Type"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Program"=? and "Frequency"=?  and "Transaction_Week"=? and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
DPH_MONTHLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DPH_Transaction" Trans, shdrc_dph."Indicator_Master_Dim" Mast,shdrc_dph."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Type"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Program"=? and "Frequency"=?  and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
DPH_QUARTERLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DPH_Transaction" Trans, shdrc_dph."Indicator_Master_Dim" Mast,shdrc_dph."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Type"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Program"=? and "Frequency"=?  and "Transaction_Quarter"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
INSERT_DPH_DIRECTORATE = insert into shdrc_data."DPH_Transaction" ("Directorate_Id","District_Id","Institution_Type","Institution_Id","Demographic_Id","General_Id","Program","General_Type","General_Name","General_SubCategory","Indicator_Id","Indicator_Name","Is_Character","Indicator_Value","Indicator_Value1","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
UPDATE_DPH_DIRECTORATE = update shdrc_data."DPH_Transaction"  set "ETL_Process_Status" ='M',"Indicator_Value"=? ,"Indicator_Value1"=? ,"Updated_On"=? where "Transaction_Key"=?;
DPH_INSTITUTION_TYPE = select  distinct Inst."Institution_Type" from shdrc_dwh."District_Master" Dist JOIN shdrc_dph."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dph."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='DPH_HUD' and Loc."District_Id"=? and Inst."Active"=1 LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by Inst."Institution_Type" asc;
INSTITUTION_NAME_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dph."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dph."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='DPH_HUD' and Loc."District_Id"=? and Inst."Active"=1 
INSTITUTION_NAME = select  Inst."Institution_Id",Inst."Institution_Name" from shdrc_dwh."District_Master" Dist JOIN shdrc_dph."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dph."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='DPH_HUD' and Inst."Institution_Type" =? and Loc."District_Id"=? and Inst."Active"=1  LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by Inst."Institution_Name" asc;
ACCESS_RESTRICTED_INSTITUTION_NAME_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dph."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dph."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='DPH_HUD' and Loc."District_Id"=? and Inst."Active"=1 LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?))
SELECT_DPH_PROGRAM=select "Program_Id","Program_Name" from shdrc_data."Program_Master" order by "Program_Name" asc;
DPH_GENERAL_CATEGORY_LIST_BY_FREQUENCY = select distinct "General_Category" from shdrc_dwh."Vw_UDSM_DPH" where "Directorate_Id"=? and "Indicator_Frequency" = ? order by "General_Category" asc;
DPH_INDICATOR_LIST = select "Indicator_Id","General_Id","Indicator_Name","General_Type","General_Name","General_SubCategory",null,"Is_Demography",null,null,"Is_Character",null from shdrc_dwh."Vw_UDSM_DPH" where "Directorate_Id"=?  and "General_Category"=? and "Indicator_Frequency"=? and "Is_Demography"=? order by "General_SubCategory","Indicator_Name","General_Type","General_Name" asc;
DPH_CLASSIFICATION_LIST=select distinct "General_Category" from shdrc_dwh."Vw_UDSM_DPH" where "Directorate_Id" =? order by "General_Category" asc;
IS_DPH_DEMOGRAPHIC=select distinct "Is_Demography" from shdrc_dwh."Vw_UDSM_DPH" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=?;


<!--NRHM Directorate -->
NRHM_DAILY_RECORDS =  select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."NRHM_Transaction" Trans, shdrc_nrhm."Indicator_Master_Dim" Mast,shdrc_nrhm."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Type"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Program"=? and "Frequency"=?  and "Transaction_Date"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
NRHM_WEEKLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."NRHM_Transaction" Trans, shdrc_nrhm."Indicator_Master_Dim" Mast,shdrc_nrhm."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Type"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Program"=? and "Frequency"=?  and "Transaction_Week"=? and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
NRHM_MONTHLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."NRHM_Transaction" Trans, shdrc_nrhm."Indicator_Master_Dim" Mast,shdrc_nrhm."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Type"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Program"=? and "Frequency"=?  and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
NRHM_QUARTERLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."NRHM_Transaction" Trans, shdrc_nrhm."Indicator_Master_Dim" Mast,shdrc_nrhm."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Type"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Program"=? and "Frequency"=?  and "Transaction_Quarter"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
INSERT_NRHM_DIRECTORATE = insert into shdrc_data."NRHM_Transaction" ("Directorate_Id","District_Id","Institution_Type","Institution_Id","Demographic_Id","General_Id","Program","General_Type","General_Name","General_SubCategory","Indicator_Id","Indicator_Name","Is_Character","Indicator_Value","Indicator_Value1","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
UPDATE_NRHM_DIRECTORATE = update shdrc_data."NRHM_Transaction"  set "ETL_Process_Status" ='M',"Indicator_Value"=? ,"Indicator_Value1"=?,"Updated_On"=? where "Transaction_Key"=?;
NRHM_GENERAL_CATEGORY_LIST_BY_FREQUENCY = select distinct "General_Category" from shdrc_dwh."Vw_UDSM_NRHM" where "Directorate_Id"=? and "Indicator_Frequency" = ? order by "General_Category" asc;
NRHM_INDICATOR_LIST = select "Indicator_Id","General_Id","Indicator_Name","General_Type","General_Name","General_SubCategory",null,"Is_Demography",null,null,"Is_Character",null from shdrc_dwh."Vw_UDSM_NRHM" where "Directorate_Id"=?  and "General_Category"=? and "Indicator_Frequency"=? and "Is_Demography"=? order by "General_SubCategory","Indicator_Name","General_Type","General_Name" asc;
NRHM_CLASSIFICATION_LIST=select distinct "General_Category" from shdrc_dwh."Vw_UDSM_NRHM" where "Directorate_Id" =? order by "General_Category" asc;
IS_NRHM_DEMOGRAPHIC=select distinct "Is_Demography" from shdrc_dwh."Vw_UDSM_NRHM" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=?;


<!--DMS Directorate -->
DMS_DAILY_RECORDS =  select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DMS_Transaction" Trans, shdrc_dms."Indicator_Master_Dim" Mast,shdrc_dms."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Date"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
DMS_WEEKLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DMS_Transaction" Trans, shdrc_dms."Indicator_Master_Dim" Mast,shdrc_dms."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Week"=? and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
DMS_MONTHLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DMS_Transaction" Trans, shdrc_dms."Indicator_Master_Dim" Mast,shdrc_dms."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
DMS_QUARTERLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DMS_Transaction" Trans, shdrc_dms."Indicator_Master_Dim" Mast,shdrc_dms."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Quarter"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
INSERT_DMS_DIRECTORATE = insert into shdrc_data."DMS_Transaction" ("Directorate_Id","District_Id","Institution_Id","Demographic_Id","General_Id","General_Type","General_Name","General_SubCategory","Indicator_Id","Indicator_Name","Is_Character","Indicator_Value","Indicator_Value1","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
UPDATE_DMS_DIRECTORATE = update shdrc_data."DMS_Transaction"  set "ETL_Process_Status" ='M',"Indicator_Value"=?,"Indicator_Value1"=?,"Updated_On"=? where "Transaction_Key"=?;
DMS_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dms."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dms."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='DMS_MIS'  and "Block_Name"='NA' and Loc."District_Id"=? and Inst."Active"=1 and Inst."Institution_Type" in ('HOSPITAL','HSC','PHC')
DMS_INSTITUTION = select  Inst."Institution_Id",Inst."Institution_Name" from shdrc_dwh."District_Master" Dist JOIN shdrc_dms."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dms."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='DMS_MIS'  and "Block_Name"='NA' and Loc."District_Id"=? and Inst."Active"=1 and Inst."Institution_Type" in ('HOSPITAL','HSC','PHC') LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by Inst."Institution_Name" asc;
ACCESS_RESTRICTED_DMS_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dms."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dms."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='DMS_MIS'  and "Block_Name"='NA' and Loc."District_Id"=? and Inst."Active"=1 and Inst."Institution_Type" in ('HOSPITAL','HSC','PHC') LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?))
DMS_GENERAL_CATEGORY_LIST_BY_FREQUENCY = select distinct "General_Category" from shdrc_dwh."Vw_UDSM_DMS" where "Directorate_Id"=? and "Indicator_Frequency" = ? order by "General_Category" asc;
DMS_INDICATOR_LIST = select "Indicator_Id","General_Id","Indicator_Name","General_Type","General_Name","General_SubCategory",null,"Is_Demography",null,null,"Is_Character",null from shdrc_dwh."Vw_UDSM_DMS" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=? and "Is_Demography"=? order by "General_SubCategory","Indicator_Name","General_Type","General_Name" asc;
DMS_CLASSIFICATION_LIST=select distinct "General_Category" from shdrc_dwh."Vw_UDSM_DMS" where "Directorate_Id" =? order by "General_Category" asc;
IS_DMS_DEMOGRAPHIC=select distinct "Is_Demography" from shdrc_dwh."Vw_UDSM_DMS" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=?;
DMS_ACCESS_RESTRICTED_DISTRICT_NAME_COUNT=select count(Distinct Dist."District_Name") from shdrc_dms."Institution_Master_Dim" Inst JOIN shdrc_dms."Location_Master" Loc ON Loc."Location_Id" = Inst."Location_Id" JOIN shdrc_dwh."District_Master" Dist ON Loc."District_Id" = Dist."District_Id" LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ? ) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "Location_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Block' AND "User_Master"."User_Name" = ? ) "User_Restrict_Block" ON Loc."Location_Id" = "User_Restrict_Block"."Location_Id"  LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ? ) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  Dist."State_Name"='Tamil Nadu' and ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR "User_Restrict_Block"."Location_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ? ));
DMS_DISTRICT_NAME=select Distinct  Dist."District_Id",Dist."District_Name" from shdrc_dms."Institution_Master_Dim" Inst JOIN shdrc_dms."Location_Master" Loc ON Loc."Location_Id" = Inst."Location_Id" JOIN shdrc_dwh."District_Master" Dist ON Loc."District_Id" = Dist."District_Id" LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ? ) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "Location_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Block' AND "User_Master"."User_Name" = ? ) "User_Restrict_Block" ON Loc."Location_Id" = "User_Restrict_Block"."Location_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ? ) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  Dist."State_Name"='Tamil Nadu' and ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR "User_Restrict_Block"."Location_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ? )) order by Dist."District_Name"  asc;


<!--RNTCP Directorate -->
RNTCP_DAILY_RECORDS =  select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."RNTCP_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Location_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Date"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
RNTCP_WEEKLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."RNTCP_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Location_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Week"=? and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
RNTCP_MONTHLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."RNTCP_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Location_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
RNTCP_QUARTERLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."RNTCP_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Location_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Quarter"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
INSERT_RNTCP_DIRECTORATE = insert into shdrc_data."RNTCP_Transaction" ("Directorate_Id","Data_Entry_Level","District_Id","Location_Id","Demographic_Id","General_Id","General_Type","General_Name","General_SubCategory","Indicator_Id","Indicator_Name","Is_Character","Indicator_Value","Indicator_Value1","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
UPDATE_RNTCP_DIRECTORATE = update shdrc_data."RNTCP_Transaction"  set "ETL_Process_Status" ='M',"Indicator_Value"=?,"Indicator_Value1"=?,"Updated_On"=? where "Transaction_Key"=?;
RNTCP_INSTITUTION_COUNT = select COUNT(Loc."Block_Name") from shdrc_dwh."HUD_Master" Hud JOIN shdrc_dwh."Location_Master" Loc ON Loc."HUD_Id" = Hud."HUD_Id" and Loc."HUD_Type"='RNTCP Geo Code' and Loc."HUD_Id"=?;
RNTCP_INSTITUTION =select Distinct Loc."Location_Id",Loc."Block_Name" from shdrc_dwh."HUD_Master" Hud JOIN shdrc_dwh."Location_Master" Loc ON Loc."HUD_Id" = Hud."HUD_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='RNTCP Geo Code' and Inst."Active"=1  and Loc."HUD_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "HUD_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'RNTCP_District' AND "User_Master"."User_Name" = ?) "User_Restrict_Hud" ON Loc."HUD_Id" = "User_Restrict_Hud"."HUD_Id" LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "Location_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Block' AND "User_Master"."User_Name" = ?) "User_Restrict_Block" ON Loc."Location_Id" = "User_Restrict_Block"."Location_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Hud"."HUD_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR "User_Restrict_Block"."Location_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by Loc."Block_Name" asc;
ACCESS_RESTRICTED_RNTCP_INSTITUTION_COUNT = select  count(Loc."Block_Name") from shdrc_dwh."HUD_Master" Hud JOIN shdrc_dwh."Location_Master" Loc ON Loc."HUD_Id" = Hud."HUD_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='RNTCP Geo Code' and Inst."Active"=1  and Loc."HUD_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "HUD_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'RNTCP_District' AND "User_Master"."User_Name" = ?) "User_Restrict_Hud" ON Loc."HUD_Id" = "User_Restrict_Hud"."HUD_Id" LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "Location_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Block' AND "User_Master"."User_Name" = ?) "User_Restrict_Block" ON Loc."Location_Id" = "User_Restrict_Block"."Location_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Hud"."HUD_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR "User_Restrict_Block"."Location_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?));
RNTCP_GENERAL_CATEGORY_LIST_BY_FREQUENCY = select distinct "General_Category" from shdrc_dwh."Vw_UDSM_RNTCP" where "Directorate_Id"=? and "Indicator_Frequency" = ? and "Ind_Hierarchy" like ? order by "General_Category" asc;
RNTCP_INDICATOR_LIST = select "Indicator_Id","General_Id","Indicator_Name","General_Type","General_Name","General_SubCategory",null,"Is_Demography",null,null,"Is_Character",null from shdrc_dwh."Vw_UDSM_RNTCP" where "Directorate_Id"=?  and "General_Category"=? and "Indicator_Frequency"=? and "Is_Demography"=? and "Ind_Hierarchy" like ? order by "General_SubCategory","Indicator_Name","General_Type","General_Name" asc;
RNTCP_CLASSIFICATION_LIST=select distinct "General_Category" from shdrc_dwh."Vw_UDSM_RNTCP" where "Directorate_Id" =? order by "General_Category" asc;
IS_RNTCP_DEMOGRAPHIC=select distinct "Is_Demography" from shdrc_dwh."Vw_UDSM_RNTCP" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=?;
RNTCP_DISTRICT_NAME_COUNT = select count(*) from shdrc_dwh."HUD_Master" where "HUD_Type"='RNTCP Geo Code';
RESTRICTED_RNTCP_DISTRICT_NAME_COUNT = select count(Distinct Hud."HUD_Name") from shdrc_dwh."Institution_Master_Dim" Inst JOIN shdrc_dwh."Location_Master" Loc ON Loc."Location_Id" = Inst."Location_Id" JOIN shdrc_dwh."HUD_Master" Hud ON Loc."HUD_Id" = Hud."HUD_Id" LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "HUD_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'RNTCP_District' AND "User_Master"."User_Name" = ? ) "User_Restrict_Hud" ON Loc."HUD_Id" = "User_Restrict_Hud"."HUD_Id" LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "Location_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Block' AND "User_Master"."User_Name" = ? ) "User_Restrict_Block" ON Loc."Location_Id" = "User_Restrict_Block"."Location_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ? ) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id"  WHERE  Hud."HUD_Type"='RNTCP Geo Code' and ("User_Restrict_Hud"."HUD_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR "User_Restrict_Block"."Location_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ? ));
RNTCP_DISTRICT_NAME = select Distinct  Hud."HUD_Id",Hud."HUD_Name" from shdrc_dwh."Institution_Master_Dim" Inst JOIN shdrc_dwh."Location_Master" Loc ON Loc."Location_Id" = Inst."Location_Id" JOIN shdrc_dwh."HUD_Master" Hud ON Loc."HUD_Id" = Hud."HUD_Id" LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "HUD_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'RNTCP_District' AND "User_Master"."User_Name" = ? ) "User_Restrict_Hud" ON Loc."HUD_Id" = "User_Restrict_Hud"."HUD_Id" LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "Location_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Block' AND "User_Master"."User_Name" = ? ) "User_Restrict_Block" ON Loc."Location_Id" = "User_Restrict_Block"."Location_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ? ) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  Hud."HUD_Type"='RNTCP Geo Code' and ("User_Restrict_Hud"."HUD_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR "User_Restrict_Block"."Location_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ? )) order by Hud."HUD_Name" asc;


<!--AIDS Directorate -->
AIDS_DAILY_RECORDS =  select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value","Is_Demography",Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."AIDS_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Type"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=? and "Is_Demography"=? and "Transaction_Date"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
AIDS_WEEKLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value","Is_Demography",Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."AIDS_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Type"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=? and "Is_Demography"=? and "Transaction_Week"=? and "Transaction_Month"=? and "Transaction_Year"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
AIDS_MONTHLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value","Is_Demography",Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."AIDS_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Type"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=? and "Is_Demography"=? and "Transaction_Month"=? and "Transaction_Year"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
AIDS_MONTHLY_DEMOGRAPHIC_RECORDS = select  Trans."Gender",Trans."Age_Group",Trans."Age_In_Days",Trans."Social",Trans."Indicator_Value",Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."AIDS_Transaction" Trans where "District_Id"=? and "Institution_Type"=? and "Institution_Id"=?  and "Frequency"=? and "Is_Demography"=? and "Indicator_Id"=? and "General_Id"=? and "Transaction_Month"=? and "Transaction_Year"=? order by "Gender","Age_Group" asc;
AIDS_QUARTERLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value","Is_Demography",Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."AIDS_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Type"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=? and "Is_Demography"=? and "Transaction_Quarter"=? and "Transaction_Year"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
INSERT_AIDS_DIRECTORATE = insert into shdrc_data."AIDS_Transaction" ("Directorate_Id","Data_Entry_Level","District_Id","Institution_Type","Institution_Id","Demographic_Id","Is_Demography","General_Id","General_Type","General_Name","General_SubCategory","Indicator_Id","Indicator_Name","Is_Character","Indicator_Value","Indicator_Value1","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
INSERT_AIDS_GENDER_AGEGROUP = insert into shdrc_data."AIDS_Transaction" ("Directorate_Id","District_Id","Institution_Id","Demographic_Id","Is_Demography","General_Id","General_Type","General_Name","Indicator_Id","Gender","Age_Group","Social","Age_In_Days","Indicator_Name","Indicator_Value","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
UPDATE_AIDS_DIRECTORATE = update shdrc_data."AIDS_Transaction"  set "ETL_Process_Status" ='M',"Indicator_Value"=? ,"Indicator_Value1"=?,"Updated_On"=? where "Transaction_Key"=?;
AIDS_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='Tansacs' and Inst."Institution_Type"='ART' and Inst."Active"=1 and Loc."District_Id"=?
AIDS_INSTITUTION = select  Inst."Institution_Id",Inst."Institution_Name" from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='Tansacs' and Inst."Active"=1 and Inst."Institution_Type"=? and Loc."District_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by Inst."Institution_Name" asc;
ACCESS_RESTRICTED_AIDS_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='Tansacs'  and Inst."Active"=1 and Inst."Institution_Type"='ART' and Loc."District_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?))
AIDS_GENERAL_CATEGORY_LIST_BY_FREQUENCY = select distinct "General_Category" from shdrc_dwh."Vw_UDSM_TANSACS" where "Directorate_Id"=? and "Indicator_Frequency" = ? and "Ind_Hierarchy" like ? order by "General_Category" asc;
AIDS_INDICATOR_LIST = select "Indicator_Id","General_Id","Indicator_Name","General_Type","General_Name","General_SubCategory",null,"Is_Demography",null,null,"Is_Character",null from shdrc_dwh."Vw_UDSM_TANSACS" where "Directorate_Id"=?  and "General_Category"=? and "Indicator_Frequency"=? and "Is_Demography"=? and "Ind_Hierarchy" like ? order by "Ind_Order","Gen_Order" asc;
AIDS_CLASSIFICATION_LIST=select distinct "General_Category" from shdrc_dwh."Vw_UDSM_TANSACS" where "Directorate_Id" =? order by "General_Category" asc;
IS_AIDS_DEMOGRAPHIC=select distinct "Is_Demography" from shdrc_dwh."Vw_UDSM_TANSACS" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=?;
AIDS_INSTITUTION_TYPE = select  distinct Inst."Institution_Type" from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='Tansacs' and Loc."District_Id"=? and Inst."Active"=1 and Inst."Institution_Type" in ('BCSU','Government Blood Banks') LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by Inst."Institution_Type" asc;


<!--TNMSC Directorate -->
TNMSC_DAILY_RECORDS =  select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."TNMSC_Transaction" Trans, shdrc_tnmsc."Indicator_Master_Dim" Mast,shdrc_tnmsc."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Warehouse_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Date"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
TNMSC_WEEKLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."TNMSC_Transaction" Trans, shdrc_tnmsc."Indicator_Master_Dim" Mast,shdrc_tnmsc."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Warehouse_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Week"=? and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
TNMSC_MONTHLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."TNMSC_Transaction" Trans, shdrc_tnmsc."Indicator_Master_Dim" Mast,shdrc_tnmsc."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Warehouse_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
TNMSC_QUARTERLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."TNMSC_Transaction" Trans, shdrc_tnmsc."Indicator_Master_Dim" Mast,shdrc_tnmsc."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Warehouse_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Quarter"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
INSERT_TNMSC_DIRECTORATE = insert into shdrc_data."TNMSC_Transaction" ("Directorate_Id","District_Id","Warehouse_Id","Demographic_Id","General_Id","General_Type","General_Name","General_SubCategory","Indicator_Id","Indicator_Name","Is_Character","Indicator_Value","Indicator_Value1","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
UPDATE_TNMSC_DIRECTORATE = update shdrc_data."TNMSC_Transaction"  set "ETL_Process_Status" ='M',"Indicator_Value"=? ,"Indicator_Value1"=?,"Updated_On"=? where "Transaction_Key"=?;
SELECT_TNMSC_INSTITUTION = select  Inst."Warehouse_Id",Inst."Warehouse_Name" from shdrc_tnmsc."TNMSC_Warehouse_Master" Inst LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "Warehouse_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Warehouse' AND "User_Master"."User_Name" = ?) "User_Restrict_Warehouse" ON Inst."Warehouse_Id" = "User_Restrict_Warehouse"."Warehouse_Id" WHERE ("User_Restrict_Warehouse"."Warehouse_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Warehouse_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by Inst."Warehouse_Id" asc;
TNMSC_GENERAL_CATEGORY_LIST_BY_FREQUENCY = select distinct "General_Category" from shdrc_dwh."Vw_UDSM_TNMSC" where "Directorate_Id"=? and "Indicator_Frequency" = ? order by "General_Category" asc;
TNMSC_INDICATOR_LIST = select "Indicator_Id",'-99',"Indicator_Name",'NA','NA','NA',null,"Is_Demography",null,null,"Is_Character",null from shdrc_dwh."Vw_UDSM_TNMSC" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=? and "Is_Demography"=? order by "Indicator_Name" asc;
TNMSC_CLASSIFICATION_LIST=select distinct "General_Category" from shdrc_dwh."Vw_UDSM_TNMSC" where "Directorate_Id" =? order by "General_Category" asc;
IS_TNMSC_DEMOGRAPHIC=select distinct "Is_Demography" from shdrc_dwh."Vw_UDSM_TNMSC" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=?;


<!--DFW Directorate -->
DFW_DAILY_RECORDS =  select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DFW_Transaction" Trans, shdrc_dfw."Indicator_Master_Dim" Mast,shdrc_dfw."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Type"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Date"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
DFW_WEEKLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DFW_Transaction" Trans, shdrc_dfw."Indicator_Master_Dim" Mast,shdrc_dfw."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Type"=?and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Week"=? and "Transaction_Month"=? and "Transaction_Year"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
DFW_MONTHLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DFW_Transaction" Trans, shdrc_dfw."Indicator_Master_Dim" Mast,shdrc_dfw."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Type"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Month"=? and "Transaction_Year"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
DFW_QUARTERLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DFW_Transaction" Trans, shdrc_dfw."Indicator_Master_Dim" Mast,shdrc_dfw."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Type"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Quarter"=? and "Transaction_Year"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
INSERT_DFW_DIRECTORATE = insert into shdrc_data."DFW_Transaction" ("Directorate_Id","Data_Entry_Level","District_Id","Institution_Type","Institution_Id","Demographic_Id","General_Id","General_Type","General_Name","General_SubCategory","Indicator_Id","Indicator_Name","Is_Character","Indicator_Value","Indicator_Value1","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
UPDATE_DFW_DIRECTORATE = update shdrc_data."DFW_Transaction"  set "ETL_Process_Status" ='M',"Indicator_Value"=? ,"Indicator_Value1"=?,"Updated_On"=? where "Transaction_Key"=?;
DFW_INSTITUTION_TYPE = select  distinct Inst."Institution_Type" from shdrc_dwh."District_Master" Dist JOIN shdrc_dfw."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dfw."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='DFW_District' and Loc."District_Id"=? and Inst."Institution_Type" in ('ESI DISPENSARY','ESI HOSPITAL','HOSPITAL','MED. COLL. HOSPITAL','MUNICIPALITY','PHC','UHP','GOVT. DISPENSARY','DIM HOSPITAL','DIRECTORATE OFFICE','LAB OFFICE','LICENSING AUTHORITY','DISPENSARY','OGH','APPROVED NH','VOL.ORG.','NGO','OTHERS') LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by Inst."Institution_Type" asc;
DFW_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dfw."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dfw."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='DFW_District' and Loc."District_Id"=? and Inst."Institution_Type" in ('ESI DISPENSARY','ESI HOSPITAL','HOSPITAL','MED. COLL. HOSPITAL','MUNICIPALITY','PHC','UHP','GOVT. DISPENSARY','DIM HOSPITAL','DIRECTORATE OFFICE','LAB OFFICE','LICENSING AUTHORITY','DISPENSARY','OGH','APPROVED NH','VOL.ORG.','NGO','OTHERS')
DFW_INSTITUTION = select  Inst."Institution_Id",Inst."Institution_Name" from shdrc_dwh."District_Master" Dist JOIN shdrc_dfw."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dfw."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='DFW_District' and Inst."Institution_Type" =? and Loc."District_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by Inst."Institution_Name" asc;
ACCESS_RESTRICTED_DFW_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dfw."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dfw."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='DFW_District' and Loc."District_Id"=? and Inst."Institution_Type" in ('ESI DISPENSARY','ESI HOSPITAL','HOSPITAL','MED. COLL. HOSPITAL','MUNICIPALITY','PHC','UHP','GOVT. DISPENSARY','DIM HOSPITAL','DIRECTORATE OFFICE','LAB OFFICE','LICENSING AUTHORITY','DISPENSARY','OGH','APPROVED NH','VOL.ORG.','NGO','OTHERS') LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?))
DFW_GENERAL_CATEGORY_LIST_BY_FREQUENCY = select distinct "General_Category" from shdrc_dwh."Vw_UDSM_DFW" where "Directorate_Id"=? and "Indicator_Frequency" = ? and "Ind_Hierarchy" like ? order by "General_Category" asc;
DFW_INDICATOR_LIST = select "Indicator_Id","General_Id","Indicator_Name","General_Type","General_Name","General_SubCategory",null,"Is_Demography",null,null,"Is_Character",null from shdrc_dwh."Vw_UDSM_DFW" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=? and "Is_Demography"=? and "Ind_Hierarchy" like ? and ("Indicator_Level"=? or "Indicator_Level"='None') order by "Ind_Order","Gen_Order" asc;
DFW_CLASSIFICATION_LIST=select distinct "General_Category" from shdrc_dwh."Vw_UDSM_DFW" where "Directorate_Id" =? order by "General_Category" asc;
IS_DFW_DEMOGRAPHIC=select distinct "Is_Demography" from shdrc_dwh."Vw_UDSM_DFW" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=?;
DFW_POST_LIST=select "General_Id","General_Name" from shdrc_dfw."General_Master" where "Directorate_Id"=? and "General_Category"='HR' and "Gen_Ref_1" in('State','District','Institution');
INSERT_EMPLOYEE_DETAILS=insert into shdrc_data."DFW_Employee_Master"("District_Id","Employee_Name","GPF_CPS_No","Gender","Designation","Pay_band","Group","Duty_Pay","Recruited_By","Grade_Pay","Community","DOB","First_Appointment_Post","First_Appointment_DOB","Regularisation","Probation_Decleration","Retirement","Increment_Due_Month","SLS_Due","Physical_Status","Punishments","Nominee_Details","Institution_Id","Marital_Status","Working_Location","Transfer_Status","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,'N',?,?) RETURNING "DFW_Employee_Master"."Employee_Id";
SELECT_EMPLOYEE_DETAILS=select "Employee_Id","Employee_Name","GPF_CPS_No","Gender","Designation","Pay_band","Group","Duty_Pay","Recruited_By","Grade_Pay","Community","DOB","First_Appointment_Post","First_Appointment_DOB","Regularisation","Probation_Decleration","Retirement","Increment_Due_Month","SLS_Due","Physical_Status","Punishments","Nominee_Details","District_Id","Institution_Id","Retirement_Type","Transfer_Status","Transfer_Type","Working_Location","Marital_Status" from shdrc_data."DFW_Employee_Master" where "Employee_Id"=?;
DFW_EMPLOYEE_LIST = select "Employee_Id","Employee_Name","GPF_CPS_No","Gender","Designation","Pay_band","Group","Duty_Pay","Recruited_By","Grade_Pay","Community","DOB","First_Appointment_Post","First_Appointment_DOB","Regularisation","Probation_Decleration","Retirement","Increment_Due_Month","SLS_Due","Physical_Status","Punishments","Nominee_Details" from shdrc_data."DFW_Employee_Master" where "District_Id"=? and "Institution_Id"=? and "Transfer_Status" in ('N','A');
INSERT_DFW_EMPLOYEE_QUALIFICATION=insert into shdrc_data."DFW_Qualification_Trans"("Employee_Id","Qualification","UG_Major","PG_Major","Others","Added_On","Added_By")values(?,?,?,?,?,?,?);
INSERT_DFW_EMPLOYEE_LEAVE=insert into shdrc_data."DFW_Leave_Trans"("Employee_Id","Recent_EL_Taken_From","Recent_EL_Taken_To","Recent_EL_Taken_Days","Recent_Bal_EL_In_SR","Recent_ML_Taken_From","Recent_ML_Taken_To","Recent_ML_Taken_Days","Recent_Bal_ML_In_SR","Recent_UEL_Taken_From","Recent_UEL_Taken_To","Recent_UEL_Taken_Days","Recent_Bal_UEL_In_SR","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
INSERT_DFW_EMPLOYEE_PROMOTION =  insert into shdrc_data."DFW_Promotion_Trans"("Employee_Id","Promotion_Type","Promotion","Promotion_DOJ","Added_On","Added_By") values(?,?,?,?,?,?);
DFW_EMPLOYEE_TRANSFER = update shdrc_data."DFW_Employee_Master" set "District_Id"=?,"Institution_Id"=?,"Transfer_Type"=?,"Transfer_Status"=?,"Updated_On"=? where "GPF_CPS_No"=?;
DFW_EMPLOYEE_EXISTS = select count("Employee_Name") from shdrc_data."DFW_Employee_Master" where "GPF_CPS_No"=?;
SELECT_EMPLOYEE_QUALIFICATION_DETAILS = select "Qualification","UG_Major","PG_Major","Others" from shdrc_data."DFW_Qualification_Trans" where "Employee_Id"=?;
SELECT_EMPLOYEE_PROMOTION_DETAILS = select "Promotion_Type","Promotion","Promotion_DOJ" from shdrc_data."DFW_Promotion_Trans" where "Employee_Id"=? order by "Promotion_Type" desc;
SELECT_EMPLOYEE_LEAVE_DETAILS = select "Recent_EL_Taken_From","Recent_EL_Taken_To","Recent_EL_Taken_Days","Recent_Bal_EL_In_SR","Recent_ML_Taken_From","Recent_ML_Taken_To","Recent_ML_Taken_Days","Recent_Bal_ML_In_SR","Recent_UEL_Taken_From","Recent_UEL_Taken_To","Recent_UEL_Taken_Days","Recent_Bal_UEL_In_SR" from shdrc_data."DFW_Leave_Trans" where "Employee_Id"=?;
UPDATE_EMPLOYEE_DETAILS = update shdrc_data."DFW_Employee_Master" set ("District_Id","Designation","Pay_band","Group","Duty_Pay","Recruited_By","Grade_Pay","Community","DOB","First_Appointment_Post","First_Appointment_DOB","Regularisation","Probation_Decleration","Retirement","Increment_Due_Month","SLS_Due","Physical_Status","Punishments","Nominee_Details","Institution_Id","Retirement_Type","Working_Location","Marital_Status","Transfer_Status","Updated_On","Added_By")=(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,'N',?,?) where "Employee_Id"=?;
UPDATE_DFW_EMPLOYEE_QUALIFICATION = update shdrc_data."DFW_Qualification_Trans" set ("Qualification","UG_Major","PG_Major","Others","Added_On","Added_By")=(?,?,?,?,?,?) where "Employee_Id"=?;
UPDATE_DFW_EMPLOYEE_LEAVE = update shdrc_data."DFW_Leave_Trans" set ("Recent_EL_Taken_From","Recent_EL_Taken_To","Recent_EL_Taken_Days","Recent_Bal_EL_In_SR","Recent_ML_Taken_From","Recent_ML_Taken_To","Recent_ML_Taken_Days","Recent_Bal_ML_In_SR","Recent_UEL_Taken_From","Recent_UEL_Taken_To","Recent_UEL_Taken_Days","Recent_Bal_UEL_In_SR","Updated_On","Added_By")=(?,?,?,?,?,?,?,?,?,?,?,?,?,?) where "Employee_Id"=?;
INSERT_DFW_EMPLOYEE_HISTORY = insert into shdrc_data."DFW_Employee_History" ("Employee_Id","Employee_Name","District_Id","GPF_CPS_No","Gender","Designation","Pay_band","Group","Duty_Pay","Recruited_By","Grade_Pay","Community","DOB","First_Appointment_Post","First_Appointment_DOB","Regularisation","Probation_Decleration","Retirement","Increment_Due_Month","SLS_Due","Physical_Status","Punishments","Nominee_Details","Qualification","UG_Major","PG_Major","Others","Recent_EL_Taken_From","Recent_EL_Taken_To","Recent_EL_Taken_Days","Recent_Bal_EL_In_SR","Recent_ML_Taken_From","Recent_ML_Taken_To","Recent_ML_Taken_Days","Recent_Bal_ML_In_SR","Recent_UEL_Taken_From","Recent_UEL_Taken_To","Recent_UEL_Taken_Days","Recent_Bal_UEL_In_SR","Promotion_Type","Promotion","Promotion_DOJ","Trans_Mode","Institution_Id","Transfer_Status","Retirement_Type","Transfer_Type","Working_Location","Marital_Status","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
DFW_EMPLOYEE_LEAVE_EXISTS=select count("Leave_Id") from shdrc_data."DFW_Leave_Trans" where "Employee_Id"=?;
DFW_TRANSFER_INSTITUTION=select Inst."Institution_Id",Inst."Institution_Name" from shdrc_dwh."District_Master" Dist JOIN shdrc_dfw."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dfw."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='DFW_District' and Inst."Institution_Type" in ('PHC','HOSPITAL') and Loc."District_Id"=? order by Inst."Institution_Name" asc;
DFW_EMPLOYEE_TRANSFER_LIST=select "Employee_Id","Employee_Name","GPF_CPS_No","Designation",dist."District_Id","District_Name",inst."Institution_Id","Institution_Name" from shdrc_data."DFW_Employee_Master" empmast join shdrc_dwh."District_Master" dist on empmast."District_Id"=dist."District_Id" left join shdrc_dfw."Institution_Master_Dim" inst on empmast."Institution_Id"=inst."Institution_Id" where empmast."Transfer_Status"='B' and empmast."Active"=1;
DFW_TRANSFER_EMPLOYEE_DETAILS=select "Employee_Name","GPF_CPS_No","Designation","Transfer_Type","District_Name","Institution_Name","Promotion","Pay_band","Group","Grade_Pay","Working_Location" from shdrc_data."DFW_Employee_Master" empmast join shdrc_dwh."District_Master" dist on empmast."District_Id"=dist."District_Id" left join shdrc_dfw."Institution_Master_Dim" inst on empmast."Institution_Id"=inst."Institution_Id" left join shdrc_data."DFW_Promotion_Trans" promo on empmast."Employee_Id"=promo."Employee_Id" where empmast."Employee_Id"=? and dist."District_Id"=? and inst."Institution_Id"=? and empmast."Transfer_Status"=? order by promo."Promotion_Type" desc;
DFW_EMPLOYEE_TRANSFER_ACCEPT=update shdrc_data."DFW_Employee_Master" set("District_Id","Institution_Id","Transfer_Type","Transfer_Status","Updated_On","Pay_band","Group","Grade_Pay","Working_Location")=(?,?,?,?,?,?,?,?,?) where "GPF_CPS_No"=?;
DFW_EMPLOYEE_PROMOTION_TYPE=select "Promotion_Type" from shdrc_data."DFW_Promotion_Trans" where "Employee_Id"=? and "Active"=1 order by "Promotion_Type" desc;
UPDATE_DFW_EMPLOYEE_PROMOTION=update shdrc_data."DFW_Promotion_Trans" set "Promotion"=?,"Promotion_DOJ"=? where "Employee_Id"=? and "Promotion_Type"=? and "Active" =1;


<!--CMCHIS Directorate -->
CMCHIS_DAILY_RECORDS =  select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",case when Gen."General_Type" is null then 'NA' else Gen."General_Type" end as "General_Type",Gen."General_Name",case when Gen."General_SubCategory" is null then 'NA' else Gen."General_SubCategory" end as "General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."CMCHIS_Transaction" Trans, shdrc_cmchis."Indicator_Master_Dim" Mast,shdrc_cmchis."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Date"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
CMCHIS_WEEKLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",case when Gen."General_Type" is null then 'NA' else Gen."General_Type" end as "General_Type",Gen."General_Name",case when Gen."General_SubCategory" is null then 'NA' else Gen."General_SubCategory" end as "General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."CMCHIS_Transaction" Trans, shdrc_cmchis."Indicator_Master_Dim" Mast,shdrc_cmchis."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Week"=? and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
CMCHIS_MONTHLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",case when Gen."General_Type" is null then 'NA' else Gen."General_Type" end as "General_Type",Gen."General_Name",case when Gen."General_SubCategory" is null then 'NA' else Gen."General_SubCategory" end as "General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."CMCHIS_Transaction" Trans, shdrc_cmchis."Indicator_Master_Dim" Mast,shdrc_cmchis."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
CMCHIS_QUARTERLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",case when Gen."General_Type" is null then 'NA' else Gen."General_Type" end as "General_Type",Gen."General_Name",case when Gen."General_SubCategory" is null then 'NA' else Gen."General_SubCategory" end as "General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."CMCHIS_Transaction" Trans, shdrc_cmchis."Indicator_Master_Dim" Mast,shdrc_cmchis."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Quarter"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
INSERT_CMCHIS_DIRECTORATE = insert into shdrc_data."CMCHIS_Transaction" ("Directorate_Id","District_Id","Institution_Id","Demographic_Id","General_Id","General_Type","General_Name","General_SubCategory","Indicator_Id","Indicator_Name","Is_Character","Indicator_Value","Indicator_Value1","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
UPDATE_CMCHIS_DIRECTORATE = update shdrc_data."CMCHIS_Transaction"  set "ETL_Process_Status" ='M',"Indicator_Value"=? ,"Indicator_Value1"=?,"Updated_On"=? where "Transaction_Key"=?;
CMCHIS_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_cmchis."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_cmchis."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='CMCHIS_District'  and Loc."District_Id"=? and Inst."Active"=1
CMCHIS_INSTITUTION = select  Inst."Institution_Id",Inst."Institution_Name" from shdrc_dwh."District_Master" Dist JOIN shdrc_cmchis."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_cmchis."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='CMCHIS_District'  and Loc."District_Id"=? and Inst."Active"=1 LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by Inst."Institution_Name" asc;
ACCESS_RESTRICTED_CMCHIS_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_cmchis."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_cmchis."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='CMCHIS_District'  and Loc."District_Id"=? and Inst."Active"=1 LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?))
CMCHIS_GENERAL_CATEGORY_LIST_BY_FREQUENCY = select distinct "General_Category" from shdrc_dwh."Vw_UDSM_CMCHIS" where "Directorate_Id"=? and "Indicator_Frequency" = ? order by "General_Category" asc;
CMCHIS_INDICATOR_LIST = select "Indicator_Id","General_Id","Indicator_Name","General_Type","General_Name","General_SubCategory",null,"Is_Demography",null,null,"Is_Character",null from shdrc_dwh."Vw_UDSM_CMCHIS" where "Directorate_Id"=?  and "General_Category"=? and "Indicator_Frequency"=? and "Is_Demography"=? order by "General_SubCategory","Indicator_Name","General_Type","General_Name" asc;
CMCHIS_CLASSIFICATION_LIST=select distinct "General_Category" from shdrc_dwh."Vw_UDSM_CMCHIS" where "Directorate_Id" =? order by "General_Category" asc;
IS_CMCHIS_DEMOGRAPHIC = select distinct "Is_Demography" from shdrc_dwh."Vw_UDSM_CMCHIS" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=?;
CMCHIS_WEBSERVICE_INSERT_PREAUTH = insert into shdrc_data."CMCHIS_Preauth_WS"("Refno","Patient_Name","Gender", "Patient_Age","Payer_Zone","Hospital","Hospital_Code","City_x002F_Location","Member_Caste_x002F_Category","Card_No","Patient_TPA_ID","First_Submission_Time","Submission_Time","Authorized_Time","TAT","Status","Package_x002F_Procedure_Name","App_Amt","REMARKS","Column_Headers","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
CMCHIS_WEBSERVICE_INSERT_CLAIMS = insert into shdrc_data."CMCHIS_Preauth_WS"("Refno","Patient_Name","Gender", "Patient_Age","Payer_Zone","Hospital","Hospital_Code","City_x002F_Location","Member_Caste_x002F_Category","Card_No","Patient_TPA_ID","First_Submission_Time","Submission_Time","Authorized_Time","TAT","Status","Package_x002F_Procedure_Name","App_Amt","REMARKS","Column_Headers","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
CMCHIS_WEBSERVICE_INSERT_HOSPITAL = insert into shdrc_data."CMCHIS_Hospital_Master_WS"("CMCHIS_Hospital_Key","Hospital_Code","Hospital_Name","Location", "Owner_Type","Added_By") values(nextval('shdrc_data."CMCHIS_Hospital_Master_WS_Key_seq"'),?,?,?,?,?);
CMCHIS_WEBSERVICE_DISABLE_HOSPITAL = update shdrc_data."CMCHIS_Hospital_Master_WS" set "Active"=0
CMCHIS_WEBSERVICE_INSERT_DC=insert into shdrc_data."CMCHIS_Preauth_WS"("Refno","Patient_Name","Gender", "Patient_Age","Payer_Zone","Hospital_Code","Diagnostic_Center","City_x002F_Location","Member_Caste_x002F_Category","Card_No","Patient_TPA_ID","Submission_Time","Authorized_Time","TAT","Status","Package_x002F_Procedure_Name","REMARKS","Column_Headers","Added_By","App_Amt") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
CMCHIS_WEBSERVICE_INSERT_PAYMENT=insert into shdrc_data."CMCHIS_DC_Payment_WS"("Refno","Hospital_Code","Hospital_Name","Payer_Zone","TDS","Other_Deduction","Net_Payable","Payment_Status","Claim_Process_Time","Eft_Creation_Time","Payment_Confirm_Time","TAT","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?);


<!--SBCS Directorate -->
SBCS_DAILY_RECORDS =  select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."SBCS_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Date"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
SBCS_WEEKLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."SBCS_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Week"=? and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
SBCS_MONTHLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."SBCS_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
SBCS_QUARTERLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."SBCS_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Quarter"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
INSERT_SBCS_DIRECTORATE = insert into shdrc_data."SBCS_Transaction" ("Directorate_Id","District_Id","Institution_Id","Demographic_Id","General_Id","General_Type","General_Name","General_SubCategory","Indicator_Id","Indicator_Name","Is_Character","Indicator_Value","Indicator_Value1","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
UPDATE_SBCS_DIRECTORATE = update shdrc_data."SBCS_Transaction"  set "ETL_Process_Status" ='M',"Indicator_Value"=? ,"Indicator_Value1"=?,"Updated_On"=? where "Transaction_Key"=?;
SBCS_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='SBCS_District'  and Loc."District_Id"=?
SBCS_INSTITUTION = select  Inst."Institution_Id",Inst."Institution_Name" from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='SBCS_District'  and Loc."District_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by Inst."Institution_Name" asc;
ACCESS_RESTRICTED_SBCS_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='SBCS_District'  and Loc."District_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?))
SBCS_GENERAL_CATEGORY_LIST_BY_FREQUENCY = select distinct "General_Category" from shdrc_dwh."Vw_UDSM_SBCS" where "Directorate_Id"=? and "Indicator_Frequency" = ? order by "General_Category" asc;
SBCS_INDICATOR_LIST = select "Indicator_Id","General_Id","Indicator_Name","General_Type","General_Name","General_SubCategory",null,"Is_Demography",null,null,"Is_Character",null from shdrc_dwh."Vw_UDSM_SBCS" where "Directorate_Id"=?  and "General_Category"=? and "Indicator_Frequency"=? and "Is_Demography"=? order by "General_SubCategory","Indicator_Name","General_Type","General_Name" asc;
SBCS_CLASSIFICATION_LIST=select distinct "General_Category" from shdrc_dwh."Vw_UDSM_SBCS" where "Directorate_Id" =? order by "General_Category" asc;
IS_SBCS_DEMOGRAPHIC=select distinct "Is_Demography" from shdrc_dwh."Vw_UDSM_SBCS" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=?;


<!--SHTO Directorate -->
SHTO_DAILY_RECORDS =  select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."SHTO_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "HUD_Id"=? and "Location_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Date"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
SHTO_WEEKLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."SHTO_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "HUD_Id"=? and "Location_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Week"=? and "Transaction_Month"=? and "Transaction_Year"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
SHTO_MONTHLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."SHTO_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "HUD_Id"=? and "Location_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Month"=? and "Transaction_Year"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
SHTO_QUARTERLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."SHTO_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "HUD_Id"=? and "Location_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Quarter"=? and "Transaction_Year"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
INSERT_SHTO_DIRECTORATE = insert into shdrc_data."SHTO_Transaction" ("Directorate_Id","HUD_Id","Location_Id","Institution_Id","General_Id","General_Type","General_Name","General_SubCategory","Indicator_Id","Indicator_Name","Is_Character","Indicator_Value","Indicator_Value1","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
UPDATE_SHTO_DIRECTORATE = update shdrc_data."SHTO_Transaction"  set "ETL_Process_Status" ='M',"Indicator_Value"=? ,"Indicator_Value1"=?,"Updated_On"=? where "Transaction_Key"=?;
SHTO_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='SHTO RWS' and Loc."District_Id"=?
SHTO_INSTITUTION = select  Inst."Institution_Id",Inst."Institution_Name" from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='SHTO RWS' and Loc."District_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by Inst."Institution_Name" asc;
ACCESS_RESTRICTED_SHTO_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='SHTO RWS' and Loc."District_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?))
SHTO_GENERAL_CATEGORY_LIST_BY_FREQUENCY = select distinct "General_Category" from shdrc_dwh."Vw_UDSM_SHTO" where "Directorate_Id"=? and "Indicator_Frequency" = ? and "Ind_Hierarchy" like ? order by "General_Category" asc;
SHTO_INDICATOR_LIST = select "Indicator_Id","General_Id","Indicator_Name","General_Type","General_Name","General_SubCategory",null,"Is_Demography",null,null,"Is_Character",null from shdrc_dwh."Vw_UDSM_SHTO" where "Directorate_Id"=?  and "General_Category"=? and "Indicator_Frequency"=? and "Is_Demography"=? and "Ind_Hierarchy" like ? order by "Ind_Order","Gen_Order" asc;
SHTO_CLASSIFICATION_LIST=select distinct "General_Category" from shdrc_dwh."Vw_UDSM_SHTO" where "Directorate_Id" =? order by "General_Category" asc;
IS_SHTO_DEMOGRAPHIC=select distinct "Is_Demography" from shdrc_dwh."Vw_UDSM_SHTO" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=?;
SHTO_WORKSHOP_NAME = select Distinct  Hud."HUD_Id",Hud."HUD_Name" from shdrc_dwh."HUD_Master" Hud JOIN shdrc_dwh."Location_Master" Loc ON Loc."HUD_Id" = Hud."HUD_Id" and Hud."HUD_Type"='SHTO RWS' and Hud."Active"=1 LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "HUD_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Region' AND "User_Master"."User_Name" = ? ) "User_Restrict_Hud" ON Hud."HUD_Id" = "User_Restrict_Hud"."HUD_Id" WHERE  ("User_Restrict_Hud"."HUD_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "HUD_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by Hud."HUD_Name" asc;
SHTO_WORKSHOP_NAME_COUNT =  select count(*) from shdrc_dwh."HUD_Master" where "HUD_Type"='SHTO RWS' and "Active"=1;
SHTO_ACCESS_RESTRICTED_WORKSHOP_NAME_COUNT = select count(Distinct Hud."HUD_Name") from shdrc_dwh."HUD_Master" Hud JOIN shdrc_dwh."Location_Master" Loc ON Loc."HUD_Id" = Hud."HUD_Id" and Hud."HUD_Type"='SHTO RWS' and Hud."Active"=1 LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "HUD_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Region' AND "User_Master"."User_Name" = ? ) "User_Restrict_Hud" ON Hud."HUD_Id" = "User_Restrict_Hud"."HUD_Id" WHERE  ("User_Restrict_Hud"."HUD_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "HUD_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?));
SHTO_MOBILE_WORKSHOP = select Inst."Institution_Id",Inst."Institution_Name" from shdrc_dwh."HUD_Master" hud join shdrc_dwh."Location_Master" loc on hud."HUD_Id"=loc."HUD_Id" join shdrc_dwh."Institution_Master_Dim" Inst on loc."Location_Id"=Inst."Location_Id" where Inst."Active"=1 and hud."HUD_Id"=?;
SHTO_MOBILE_WORKSHOP_COUNT = select count(*) from shdrc_dwh."Institution_Master_Dim" where "Location_Id"=? and "Active"=1;
ACCESS_RESTRICTED_SHTO_MOBILE_WORKSHOP_COUNT = select count(Distinct Dist."District_Name") from shdrc_dwh."Institution_Master_Dim" Inst JOIN shdrc_dwh."Location_Master" Loc ON Loc."Location_Id" = Inst."Location_Id" JOIN shdrc_dwh."District_Master" Dist ON Loc."District_Id" = Dist."District_Id" LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ? ) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "Location_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Block' AND "User_Master"."User_Name" = ? ) "User_Restrict_Block" ON Loc."Location_Id" = "User_Restrict_Block"."Location_Id"  LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ? ) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  Dist."State_Name"='Tamil Nadu' and ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR "User_Restrict_Block"."Location_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ? ));


<!--NLEP Directorate -->
NLEP_DAILY_RECORDS =  select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value","Is_Demography",Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."NLEP_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=? and "Is_Demography"=? and "Transaction_Date"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
NLEP_WEEKLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value","Is_Demography",Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."NLEP_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=? and "Is_Demography"=? and "Transaction_Week"=? and "Transaction_Month"=? and "Transaction_Year"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
NLEP_MONTHLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value","Is_Demography",Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."NLEP_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Is_Demography"=? and "Transaction_Month"=? and "Transaction_Year"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
NLEP_QUARTERLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value","Is_Demography",Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."NLEP_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=? and "Is_Demography"=? and "Transaction_Quarter"=? and "Transaction_Year"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
NLEP_MONTHLY_DEMOGRAPHIC_RECORDS = select  Trans."Gender",Trans."Age_Group",Trans."Age_In_Days",Trans."Social",Trans."Indicator_Value",Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."NLEP_Transaction" Trans where "District_Id"=? and "Institution_Id"=?  and "Frequency"=? and "Is_Demography"=? and "Indicator_Id"=? and "General_Id"=? and "Transaction_Month"=? and "Transaction_Year"=? order by "Gender","Age_Group" asc;
INSERT_NLEP_DIRECTORATE = insert into shdrc_data."NLEP_Transaction" ("Directorate_Id","District_Id","Institution_Id","Demographic_Id","Is_Demography","General_Id","General_Type","General_Name","General_SubCategory","Indicator_Id","Indicator_Name","Is_Character","Indicator_Value","Indicator_Value1","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
INSERT_NLEP_GENDER_AGEGROUP = insert into shdrc_data."NLEP_Transaction" ("Directorate_Id","District_Id","Institution_Id","Demographic_Id","Is_Demography","General_Id","General_Type","General_Name","Indicator_Id","Gender","Age_Group","Social","Age_In_Days","Indicator_Name","Indicator_Value","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
UPDATE_NLEP_DIRECTORATE = update shdrc_data."NLEP_Transaction"  set "ETL_Process_Status" ='M',"Indicator_Value"=? ,"Indicator_Value1"=?,"Updated_On"=? where "Transaction_Key"=?;
NLEP_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='District' and Loc."District_Id"=?
NLEP_INSTITUTION = select  Inst."Institution_Id",Inst."Institution_Name" from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='District' and Loc."District_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by Inst."Institution_Name" asc;
ACCESS_RESTRICTED_NLEP_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='District' and Loc."District_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?))
NLEP_GENERAL_CATEGORY_LIST_BY_FREQUENCY = select distinct "General_Category",case when "General_Category"='Leprosy' then 1 when "General_Category"='Drug' then 2 when "General_Category"='DPMR' then 3 when "General_Category"='District Performance(Budget)' then 4 when "General_Category"='Statement of Expenditure(Budget)' then 5 end as "Gen_Ordr" from shdrc_dwh."Vw_UDSM_NLEP" where "Directorate_Id"=? and "Indicator_Frequency" = ? order by "Gen_Ordr" asc;
NLEP_INDICATOR_LIST = select "Indicator_Id","General_Id","Indicator_Name","General_Type","General_Name","General_SubCategory",null,"Is_Demography",null,null,"Is_Character",null from shdrc_dwh."Vw_UDSM_NLEP" where "Directorate_Id"=?  and "General_Category"=? and "Indicator_Frequency"=? and "Is_Demography"=? order by "Ind_Order","Gen_Order" asc;
NLEP_CLASSIFICATION_LIST=select distinct "General_Category",case when "General_Category"='Leprosy' then 1 when "General_Category"='Drug' then 2 when "General_Category"='DPMR' then 3 when "General_Category"='District Performance(Budget)' then 4 when "General_Category"='Statement of Expenditure(Budget)' then 5 end as "Gen_Order" from shdrc_dwh."Vw_UDSM_NLEP" where "Directorate_Id" =? order by "Gen_Order" asc;
IS_NLEP_DEMOGRAPHIC=select distinct "Is_Demography" from shdrc_dwh."Vw_UDSM_NLEP" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=?;
NLEP_YEARLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value","Is_Demography",Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."NLEP_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Is_Demography"=? and "Transaction_Year"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;


<!--MRB Directorate -->
MRB_DAILY_RECORDS =  select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."MRB_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Date"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
MRB_WEEKLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."MRB_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Week"=? and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
MRB_MONTHLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."MRB_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
MRB_QUARTERLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."MRB_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Quarter"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
MRB_YEARLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."MRB_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
INSERT_MRB_DIRECTORATE = insert into shdrc_data."MRB_Transaction" ("Directorate_Id","District_Id","Institution_Id","Demographic_Id","General_Id","General_Type","General_Name","General_SubCategory","Indicator_Id","Indicator_Name","Is_Character","Indicator_Value","Indicator_Value1","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
UPDATE_MRB_DIRECTORATE = update shdrc_data."MRB_Transaction"  set "ETL_Process_Status" ='M',"Indicator_Value"=? ,"Indicator_Value1"=?,"Updated_On"=? where "Transaction_Key"=?;
MRB_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='NA' and Loc."District_Id"=?
MRB_INSTITUTION = select  Inst."Institution_Id",Inst."Institution_Name" from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='NA' and Loc."District_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by Inst."Institution_Name" asc;
ACCESS_RESTRICTED_MRB_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='NA' and Loc."District_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?))
MRB_GENERAL_CATEGORY_LIST_BY_FREQUENCY = select distinct "General_Category" from shdrc_dwh."Vw_UDSM_MRB" where "Directorate_Id"=? and "Indicator_Frequency" = ? order by "General_Category" asc;
MRB_INDICATOR_LIST = select "Indicator_Id","General_Id","Indicator_Name","General_Type","General_Name","General_SubCategory",null,"Is_Demography",null,null,"Is_Character",null from shdrc_dwh."Vw_UDSM_MRB" where "Directorate_Id"=?  and "General_Category"=? and "Indicator_Frequency"=? and "Is_Demography"=? order by "General_SubCategory","Indicator_Name","General_Type","General_Name" asc;
MRB_CLASSIFICATION_LIST=select distinct "General_Category" from shdrc_dwh."Vw_UDSM_MRB" where "Directorate_Id" =? order by "General_Category" asc;
IS_MRB_DEMOGRAPHIC=select distinct "Is_Demography" from shdrc_dwh."Vw_UDSM_MRB" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=?;


<!--DFS Directorate -->
DFS_DAILY_RECORDS =  select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DFS_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "HUD_Id"=? and "Location_Id"=? and "Institution_Type"=? and "Institution_Speciality_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Date"=? order by "Ind_Order","Gen_Order" asc;
DFS_WEEKLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DFS_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "HUD_Id"=? and "Location_Id"=? and "Institution_Type"=? and "Institution_Speciality_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Week"=? and "Transaction_Month"=? and "Transaction_Year"=? order by "Ind_Order","Gen_Order" asc;
DFS_MONTHLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DFS_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "HUD_Id"=? and "Location_Id"=? and "Institution_Type"=? and "Institution_Speciality_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Month"=? and "Transaction_Year"=? order by "Ind_Order","Gen_Order" asc;
DFS_QUARTERLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DFS_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "HUD_Id"=? and "Location_Id"=? and "Institution_Type"=? and "Institution_Speciality_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Quarter"=? and "Transaction_Year"=? order by "Ind_Order","Gen_Order" asc;
INSERT_DFS_DIRECTORATE = insert into shdrc_data."DFS_Transaction" ("Directorate_Id","District_Id","HUD_Id","Location_Id","Institution_Type","Institution_Speciality_Id","Institution_Id","Demographic_Id","Data_Entry_Level","General_Id","General_Type","General_Name","General_SubCategory","Indicator_Id","Indicator_Name","Is_Character","Indicator_Value","Indicator_Value1","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
UPDATE_DFS_DIRECTORATE = update shdrc_data."DFS_Transaction"  set "ETL_Process_Status" ='M',"Indicator_Value"=? ,"Indicator_Value1"=?,"Updated_On"=? where "Transaction_Key"=?;
DFS_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='DFS_District' and Loc."District_Id"=?
DFS_INSTITUTION = select  Inst."Institution_Id",Inst."Institution_Name" from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='DFS_District' and Loc."District_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by Inst."Institution_Name" asc;
ACCESS_RESTRICTED_DFS_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='DFS_District' and Loc."District_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?))
DFS_GENERAL_CATEGORY_LIST_BY_FREQUENCY = select distinct "General_Category" from shdrc_dwh."Vw_UDSM_DFS" where "Directorate_Id"=? and "Indicator_Frequency" = ? and "Ind_Hierarchy" like ? order by "General_Category" asc;
DFS_INDICATOR_LIST = select "Indicator_Id","General_Id","Indicator_Name","General_Type","General_Name","General_SubCategory",null,"Is_Demography",null,null,"Is_Character",null from shdrc_dwh."Vw_UDSM_DFS" where "Directorate_Id"=?  and "General_Category"=? and "Indicator_Frequency"=? and "Is_Demography"=? and "Ind_Hierarchy" like ? order by "Ind_Order","Gen_Order" asc;
DFS_CLASSIFICATION_LIST=select distinct "General_Category" from shdrc_dwh."Vw_UDSM_DFS" where "Directorate_Id" =? order by "General_Category" asc;
IS_DFS_DEMOGRAPHIC=select distinct "Is_Demography" from shdrc_dwh."Vw_UDSM_DFS" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=?;
DFS_LAB = select hud."HUD_Id",hud."HUD_Name" from shdrc_dwh."HUD_Master" hud LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "HUD_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Lab' AND "User_Master"."User_Name" = ?) "User_Restrict_Zone" ON hud."HUD_Id" = "User_Restrict_Zone"."HUD_Id" WHERE  hud."HUD_Type"='DFS_Type' and hud."Active"=1and "HUD_Name" like '%FAL%' and ("User_Restrict_Zone"."HUD_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "HUD_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by hud."HUD_Name" asc;
DFS_LAB_DISTRICT = select distinct "Location_Id","Block_Name" from shdrc_dwh."Location_Master" where "HUD_Type"='DFS_Type' and "Active"=1 and "HUD_Id"=? order by "Block_Name" asc;
DFS_AREA_TYPE = select distinct "Institution_Type" from shdrc_dwh."HUD_Master" Hud JOIN shdrc_dwh."Location_Master" Loc ON Hud."HUD_Id" = Loc."HUD_Id" JOIN shdrc_dwh."Institution_Master_Dim" inst ON Loc."Location_Id" = Inst."Location_Id" where Hud."HUD_Id"=? and Loc."Location_Id"=? and Inst."Active"=1 order by "Institution_Type" asc; 
DFS_AREA = select distinct "Institution_Speciality_Id" from shdrc_dwh."HUD_Master" Hud JOIN shdrc_dwh."Location_Master" Loc ON Hud."HUD_Id" = Loc."HUD_Id" JOIN shdrc_dwh."Institution_Master_Dim" inst ON Loc."Location_Id" = Inst."Location_Id" where Hud."HUD_Id"=? and Loc."Location_Id"=? and Inst."Institution_Type"=? and Inst."Active"=1 order by "Institution_Speciality_Id" asc;
DFS_AREACODE = select distinct "Institution_Id","Institution_Name" from shdrc_dwh."HUD_Master" Hud JOIN shdrc_dwh."Location_Master" Loc ON Hud."HUD_Id" = Loc."HUD_Id" JOIN shdrc_dwh."Institution_Master_Dim" inst ON Loc."Location_Id" = Inst."Location_Id" where Hud."HUD_Id"=? and Loc."Location_Id"=? and Inst."Institution_Type"=? and Inst."Institution_Speciality_Id"=? and Inst."Active"=1 order by "Institution_Name" asc;


<!--DCA Directorate -->
DCA_DAILY_RECORDS =  select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DCA_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "HUD_Id"=? and "Location_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Date"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
DCA_WEEKLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DCA_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "HUD_Id"=? and "Location_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Week"=? and "Transaction_Month"=? and "Transaction_Year"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
DCA_MONTHLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DCA_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "HUD_Id"=? and "Location_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Month"=? and "Transaction_Year"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
DCA_QUARTERLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DCA_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "HUD_Id"=? and "Location_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Quarter"=? and "Transaction_Year"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
INSERT_DCA_DIRECTORATE = insert into shdrc_data."DCA_Transaction" ("Directorate_Id","HUD_Id","Location_Id","Institution_Id","Data_Entry_Level","Demographic_Id","General_Id","General_Type","General_Name","General_SubCategory","Indicator_Id","Indicator_Name","Is_Character","Indicator_Value","Indicator_Value1","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
UPDATE_DCA_DIRECTORATE = update shdrc_data."DCA_Transaction" set "ETL_Process_Status" ='M',"Indicator_Value"=? ,"Indicator_Value1"=?,"Updated_On"=? where "Transaction_Key"=?;
DCA_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='DCA_District' and Loc."District_Id"=?
DCA_INSTITUTION = select  Inst."Institution_Id",Inst."Institution_Name" from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='DCA_District' and Loc."District_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by Inst."Institution_Name" asc;
ACCESS_RESTRICTED_DCA_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='DCA_District' and Loc."District_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?))
DCA_GENERAL_CATEGORY_LIST_BY_FREQUENCY = select distinct "General_Category" from shdrc_dwh."Vw_UDSM_DCA" where "Directorate_Id"=? and "Indicator_Frequency" = ? and "Ind_Hierarchy" like ? order by "General_Category" asc;
DCA_INDICATOR_LIST = select "Indicator_Id","General_Id","Indicator_Name","General_Type","General_Name","General_SubCategory",null,"Is_Demography",null,null,"Is_Character",null from shdrc_dwh."Vw_UDSM_DCA" where "Directorate_Id"=?  and "General_Category"=? and "Indicator_Frequency"=? and "Is_Demography"=? and "Ind_Hierarchy" like ? order by "Ind_Order","Gen_Order" asc;
DCA_CLASSIFICATION_LIST=select distinct "General_Category" from shdrc_dwh."Vw_UDSM_DCA" where "Directorate_Id" =? order by "General_Category" asc;
IS_DCA_DEMOGRAPHIC=select distinct "Is_Demography" from shdrc_dwh."Vw_UDSM_DCA" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=?;
DCA_HUD_NAME = select hud."HUD_Id",hud."HUD_Name" from shdrc_dwh."HUD_Master" hud LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "HUD_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Zones' AND "User_Master"."User_Name" = ?) "User_Restrict_Zone" ON hud."HUD_Id" = "User_Restrict_Zone"."HUD_Id" WHERE  hud."HUD_Type"='DCA_District' and hud."Active"=1 and ("User_Restrict_Zone"."HUD_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "HUD_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by hud."HUD_Name" asc;
BLOCK_NAME = select "Location_Id","Block_Name" from shdrc_dwh."Location_Master" where "HUD_Id"=? and "Active"=1;
DCA_INSTITUTION_NAME = select distinct "Institution_Id","Institution_Name" from shdrc_dwh."HUD_Master" Hud JOIN shdrc_dwh."Location_Master" Loc on Hud."HUD_Id" = Loc."HUD_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst on Loc."Location_Id"=Inst."Location_Id" where Hud."HUD_Id"=? and Hud."HUD_Type"='DCA_District' and Inst."Active"=1 order by "Institution_Name" asc;


<!--DME Directorate -->
DME_DAILY_RECORDS =  select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DME_Transaction" Trans, shdrc_dme."Indicator_Master_Dim" Mast,shdrc_dme."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Date"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
DME_WEEKLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DME_Transaction" Trans, shdrc_dme."Indicator_Master_Dim" Mast,shdrc_dme."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Week"=? and "Transaction_Month"=? and "Transaction_Year"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
DME_MONTHLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DME_Transaction" Trans, shdrc_dme."Indicator_Master_Dim" Mast,shdrc_dme."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Month"=? and "Transaction_Year"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
DME_QUARTERLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DME_Transaction" Trans, shdrc_dme."Indicator_Master_Dim" Mast,shdrc_dme."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Quarter"=? and "Transaction_Year"=? order by Mast."Ind_Order",Gen."Gen_Order" asc;
INSERT_DME_DIRECTORATE = insert into shdrc_data."DME_Transaction" ("Directorate_Id","District_Id","Institution_Id","Demographic_Id","General_Id","General_Type","General_Name","General_SubCategory","Indicator_Id","Indicator_Name","Is_Character","Indicator_Value","Indicator_Value1","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
UPDATE_DME_DIRECTORATE = update shdrc_data."DME_Transaction"  set "ETL_Process_Status" ='M',"Indicator_Value"=? ,"Indicator_Value1"=?,"Updated_On"=? where "Transaction_Key"=?;
DME_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dme."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dme."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='DME' and Inst."Institution_Speciality_Id"='DME_Type' and Loc."District_Id"=?
DME_INSTITUTION = select  Inst."Institution_Id",Inst."Institution_Name" from shdrc_dwh."District_Master" Dist JOIN shdrc_dme."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dme."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='DME' and Inst."Institution_Speciality_Id"='DME_Type' and Loc."District_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by Inst."Institution_Name" asc;
ACCESS_RESTRICTED_DME_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dme."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dme."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='DME' and Inst."Institution_Speciality_Id"='DME_Type' and Loc."District_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?))
DME_GENERAL_CATEGORY_LIST_BY_FREQUENCY = select distinct "General_Category" from shdrc_dwh."Vw_UDSM_DME" where "Directorate_Id"=? and "Indicator_Frequency" = ? order by "General_Category" asc;
DME_INDICATOR_LIST = select "Indicator_Id","General_Id","Indicator_Name","General_Type","General_Name","General_SubCategory",null,"Is_Demography",null,null,"Is_Character",null from shdrc_dwh."Vw_UDSM_DME" where "Directorate_Id"=?  and "General_Category"=? and "Indicator_Frequency"=? and "Is_Demography"=? order by "Ind_Order","Gen_Order" asc;
DME_CLASSIFICATION_LIST=select distinct "General_Category" from shdrc_dwh."Vw_UDSM_DME" where "Directorate_Id" =? order by "General_Category" asc;
IS_DME_DEMOGRAPHIC=select distinct "Is_Demography" from shdrc_dwh."Vw_UDSM_DME" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=?;
DME_ACCESS_RESTRICTED_DISTRICT_NAME_COUNT=select count(Distinct Dist."District_Name") from shdrc_dme."Institution_Master_Dim" Inst JOIN shdrc_dme."Location_Master" Loc ON Loc."Location_Id" = Inst."Location_Id" JOIN shdrc_dwh."District_Master" Dist ON Loc."District_Id" = Dist."District_Id" LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ? ) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "Location_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Block' AND "User_Master"."User_Name" = ? ) "User_Restrict_Block" ON Loc."Location_Id" = "User_Restrict_Block"."Location_Id"  LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ? ) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  Dist."State_Name"='Tamil Nadu' and ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR "User_Restrict_Block"."Location_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ? ));
DME_DISTRICT_NAME=select Distinct  Dist."District_Id",Dist."District_Name" from shdrc_dme."Institution_Master_Dim" Inst JOIN shdrc_dme."Location_Master" Loc ON Loc."Location_Id" = Inst."Location_Id" JOIN shdrc_dwh."District_Master" Dist ON Loc."District_Id" = Dist."District_Id" LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ? ) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "Location_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Block' AND "User_Master"."User_Name" = ? ) "User_Restrict_Block" ON Loc."Location_Id" = "User_Restrict_Block"."Location_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ? ) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  Dist."State_Name"='Tamil Nadu' and ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR "User_Restrict_Block"."Location_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ? )) order by Dist."District_Name"  asc;


<!--DRMGR Directorate -->
DRMGR_DAILY_RECORDS =  select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DRMGR_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "Institution_Speciality_Id"=? and "Institution_Type"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Date"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
DRMGR_WEEKLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DRMGR_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "Institution_Speciality_Id"=? and "Institution_Type"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Week"=? and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
DRMGR_MONTHLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DRMGR_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "HUD_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
DRMGR_QUARTERLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DRMGR_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "HUD_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Quarter"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
DRMGR_YEARLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DRMGR_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "Institution_Speciality_Id"=? and "Institution_Type"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
INSERT_DRMGR_DIRECTORATE = insert into shdrc_data."DRMGR_Transaction" ("Directorate_Id","HUD_Id","Data_Entry_Level","Demographic_Id","General_Id","General_Type","General_Name","General_SubCategory","Indicator_Id","Indicator_Name","Is_Character","Indicator_Value","Indicator_Value1","Frequency","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
UPDATE_DRMGR_DIRECTORATE = update shdrc_data."DRMGR_Transaction"  set "ETL_Process_Status" ='M',"Indicator_Value"=? ,"Indicator_Value1"=?,"Updated_On"=? where "Transaction_Key"=?;
DRMGR_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='NA' and Loc."District_Id"=?
DRMGR_INSTITUTION = select  Inst."Institution_Id",Inst."Institution_Name" from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='NA' and Loc."District_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by Inst."Institution_Name" asc;
ACCESS_RESTRICTED_DRMGR_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='NA' and Loc."District_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?))
DRMGR_GENERAL_CATEGORY_LIST_BY_FREQUENCY = select distinct "General_Category" from shdrc_dwh."Vw_UDSM_DrMGR" where "Directorate_Id"=? and "Indicator_Frequency" = ? and "Ind_Hierarchy" like ? order by "General_Category" asc;
DRMGR_INDICATOR_LIST = select "Indicator_Id","General_Id","Indicator_Name","General_Type","General_Name","General_SubCategory",null,"Is_Demography",null,null,"Is_Character",null from shdrc_dwh."Vw_UDSM_DrMGR" where "Directorate_Id"=?  and "General_Category"=? and "Indicator_Frequency"=? and "Is_Demography"=? and "Ind_Hierarchy" like ? order by "General_SubCategory","Indicator_Name","General_Type","General_Name" asc;
DRMGR_CLASSIFICATION_LIST=select distinct "General_Category" from shdrc_dwh."Vw_UDSM_DrMGR" where "Directorate_Id" =? order by "General_Category" asc;
IS_DRMGR_DEMOGRAPHIC=select distinct "Is_Demography" from shdrc_dwh."Vw_UDSM_DrMGR" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=?;
DRMGR_INSTITUTIONTYPELIST = select distinct "Institution_Speciality_Id" from shdrc_dwh."Institution_Master_Dim" where "Institution_Type"='MGR_Institution' and "Institution_Speciality_Id" <> '';
DRMGR_INSTITUTIONSPECIALITYLIST = select distinct "Institution_Type" from shdrc_dwh."Institution_Master_Dim" where "Institution_Type" in ('MGR_Institution','IMH','DEN','MED','AHS') and "Institution_Speciality_Id"=? and "Active"=1;
DRMGR_INSTITUTIONLIST = select distinct ("Institution_Id"),"Institution_Name" from shdrc_dwh."Institution_Master_Dim" where "Institution_Speciality_Id"=? and "Institution_Type"=? and "Active"=1
DRMGR_DEPARTMENT =  select hud."HUD_Id",hud."HUD_Name" from shdrc_dwh."HUD_Master" hud LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "HUD_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Department' AND "User_Master"."User_Name" = ?) "User_Restrict_Zone" ON hud."HUD_Id" = "User_Restrict_Zone"."HUD_Id" WHERE  hud."HUD_Type"='MGR_Dept' and hud."Active"=1 and hud."HUD_Name" NOT IN ('AHS','MED','DEN','NU1','IMH','NA','DENTAL SURGERY','PHARMACY','MEDICINE AND SURGERY','NURSING','SCIENCE','MEDICINE AND MEDICAL SPECIALITIES') and ("User_Restrict_Zone"."HUD_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "HUD_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by hud."HUD_Name" asc;
DRMGR_DEPARTMENT_COUNT = select COUNT("HUD_Name") from shdrc_dwh."HUD_Master" where "HUD_Type"='MGR_Dept' and "Active"=1 and "HUD_Name" NOT IN ('NA','DENTAL SURGERY','PHARMACY','MEDICINE AND SURGERY','NURSING','SCIENCE','MEDICINE AND MEDICAL SPECIALITIES');
ACCESS_RESTRICTED_DRMGR_DEPARTMENT_COUNT = select COUNT("HUD_Name") from shdrc_dwh."HUD_Master" hud LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "HUD_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Department' AND "User_Master"."User_Name" = ?) "User_Restrict_Zone" ON hud."HUD_Id" = "User_Restrict_Zone"."HUD_Id" WHERE  hud."HUD_Type"='MGR_Dept' and hud."Active"=1 and ("User_Restrict_Zone"."HUD_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "HUD_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) and hud."HUD_Name" NOT IN ('NA','DENTAL SURGERY','PHARMACY','MEDICINE AND SURGERY','NURSING','SCIENCE','MEDICINE AND MEDICAL SPECIALITIES');


<!--DIM Directorate -->
DIM_DAILY_RECORDS =  select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DIM_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "System"=? and "District_Id"=? and "Institution_Type"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Date"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
DIM_WEEKLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DIM_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "System"=? and "District_Id"=? and "Institution_Type"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Week"=? and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
DIM_MONTHLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DIM_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "System"=? and "District_Id"=? and "Institution_Type"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
DIM_QUARTERLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DIM_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "System"=? and "District_Id"=? and "Institution_Type"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Quarter"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
DIM_YEARLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."DIM_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "System"=? and "District_Id"=? and "Institution_Type"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
INSERT_DIM_DIRECTORATE = insert into shdrc_data."DIM_Transaction" ("Directorate_Id","System","District_Id","Institution_Type","Institution_Id","Demographic_Id","General_Id","General_Type","General_Name","General_SubCategory","Indicator_Id","Indicator_Name","Is_Character","Indicator_Value","Indicator_Value1","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
UPDATE_DIM_DIRECTORATE = update shdrc_data."DIM_Transaction"  set "ETL_Process_Status" ='M',"Indicator_Value"=? ,"Indicator_Value1"=? ,"Updated_On"=? where "Transaction_Key"=?;
DIM_INSTITUTION_TYPE=select  distinct Inst."Institution_Speciality_Id" from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='IM_District' and "Block_Name"='NA' and Inst."Institution_Type"=? and Loc."District_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by Inst."Institution_Speciality_Id" asc;
DIM_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='IM_District' and Loc."District_Id"=?
DIM_INSTITUTION = select  Inst."Institution_Id",Inst."Institution_Name" from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='IM_District' and Inst."Institution_Type" =?  and Loc."District_Id"=? and  Inst."Institution_Speciality_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by Inst."Institution_Name" asc;
ACCESS_RESTRICTED_DIM_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='IM_District' and Loc."District_Id"=? LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?))
DIM_SYSTEM=select "System_Id","System_Name" from shdrc_data."System_Master" where "Active"=1 order by "System_Name" asc;
DIM_GENERAL_CATEGORY_LIST_BY_FREQUENCY = select distinct "General_Category" from shdrc_dwh."Vw_UDSM_DIM" where "Directorate_Id"=? and "Indicator_Frequency" = ? order by "General_Category" asc;
DIM_INDICATOR_LIST = select "Indicator_Id","General_Id","Indicator_Name","General_Type","General_Name","General_SubCategory",null,"Is_Demography",null,null,"Is_Character",null from shdrc_dwh."Vw_UDSM_DIM" where "Directorate_Id"=?  and "General_Category"=? and "Indicator_Frequency"=? and "Is_Demography"=? order by "General_SubCategory","Indicator_Name","General_Type","General_Name" asc;
DIM_INDICATOR_LIST1 = select "Indicator_Id","General_Id","Indicator_Name","General_Type","General_Name","General_SubCategory",null,"Is_Demography",null,null,"Is_Character",null from shdrc_dwh."Vw_UDSM_DIM" where "Directorate_Id"=?  and "General_Category"=? and "Indicator_Frequency"=? and "Is_Demography"=? and "General_SubCategory"=? order by "General_SubCategory","Indicator_Name","General_Type","General_Name" asc;
DIM_CLASSIFICATION_LIST=select distinct "General_Category" from shdrc_dwh."Vw_UDSM_DIM" where "Directorate_Id" =? order by "General_Category" asc;
IS_DIM_DEMOGRAPHIC=select distinct "Is_Demography" from shdrc_dwh."Vw_UDSM_DIM" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=?;


<!--ESI Directorate -->
ESI_DAILY_RECORDS =  select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."ESI_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Date"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
ESI_WEEKLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."ESI_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Week"=? and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
ESI_MONTHLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."ESI_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
ESI_QUARTERLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."ESI_Transaction" Trans, shdrc_dwh."Indicator_Master_Dim" Mast,shdrc_dwh."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Quarter"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
INSERT_ESI_DIRECTORATE = insert into shdrc_data."ESI_Transaction" ("Directorate_Id","District_Id","Institution_Id","Demographic_Id","General_Id","General_Type","General_Name","General_SubCategory","Indicator_Id","Indicator_Name","Is_Character","Indicator_Value","Indicator_Value1","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
UPDATE_ESI_DIRECTORATE = update shdrc_data."ESI_Transaction"  set "ETL_Process_Status" ='M',"Indicator_Value"=? ,"Indicator_Value1"=?,"Updated_On"=? where "Transaction_Key"=?;
ESI_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='HUD_MIS' and Loc."District_Id"=? and Inst."Institution_Type" in ('ESI HOSPITAL','ESI DISPENSARY')
ESI_INSTITUTION = select  Inst."Institution_Id",Inst."Institution_Name" from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='HUD_MIS' and Loc."District_Id"=? and Inst."Institution_Type" in ('ESI HOSPITAL','ESI DISPENSARY') LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by Inst."Institution_Name" asc;
ACCESS_RESTRICTED_ESI_INSTITUTION_COUNT = select COUNT(Inst."Institution_Name") from shdrc_dwh."District_Master" Dist JOIN shdrc_dwh."Location_Master" Loc ON Loc."District_Id" = Dist."District_Id" JOIN shdrc_dwh."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Loc."HUD_Type"='HUD_MIS' and Loc."District_Id"=? and Inst."Institution_Type" in ('ESI HOSPITAL','ESI DISPENSARY') LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "District_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'District' AND "User_Master"."User_Name" = ?) "User_Restrict_Dist" ON Loc."District_Id" = "User_Restrict_Dist"."District_Id" LEFT JOIN (SELECT "User_Roles"."Role_Restrict_Id" "Institution_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Institution' AND "User_Master"."User_Name" = ?) "User_Restrict_Inst" ON "User_Restrict_Inst"."Institution_Id" = Inst."Institution_Id" WHERE  ("User_Restrict_Dist"."District_Id" IS NOT NULL OR "User_Restrict_Inst"."Institution_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "Institution_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?))
ESI_GENERAL_CATEGORY_LIST_BY_FREQUENCY = select distinct "General_Category" from shdrc_dwh."Vw_UDSM_ESI" where "Directorate_Id"=? and "Indicator_Frequency" = ? order by "General_Category" asc;
ESI_INDICATOR_LIST = select "Indicator_Id","General_Id","Indicator_Name","General_Type","General_Name","General_SubCategory",null,"Is_Demography",null,null,"Is_Character",null from shdrc_dwh."Vw_UDSM_ESI" where "Directorate_Id"=?  and "General_Category"=? and "Indicator_Frequency"=? and "Is_Demography"=? order by "General_SubCategory","Indicator_Name","General_Type","General_Name" asc;
ESI_CLASSIFICATION_LIST=select distinct "General_Category" from shdrc_dwh."Vw_UDSM_ESI" where "Directorate_Id" =? order by "General_Category" asc;
IS_ESI_DEMOGRAPHIC=select distinct "Is_Demography" from shdrc_dwh."Vw_UDSM_ESI" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=?;


<!--COC Directorate -->
COC_DAILY_RECORDS =  select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."COC_Transaction" Trans, shdrc_coc."Indicator_Master_Dim" Mast,shdrc_coc."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "Region_Name"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Date"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
COC_WEEKLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."COC_Transaction" Trans, shdrc_coc."Indicator_Master_Dim" Mast,shdrc_coc."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "Region_Name"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Week"=? and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
COC_MONTHLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."COC_Transaction" Trans, shdrc_coc."Indicator_Master_Dim" Mast,shdrc_coc."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "Region_Name"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
COC_QUARTERLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."COC_Transaction" Trans, shdrc_coc."Indicator_Master_Dim" Mast,shdrc_coc."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "Region_Name"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Quarter"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
INSERT_COC_DIRECTORATE = insert into shdrc_data."COC_Transaction" ("Directorate_Id","Region_Name","Institution_Id","General_Id","General_Type","General_Name","General_SubCategory","Indicator_Id","Indicator_Name","Is_Character","Indicator_Value","Indicator_Value1","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
UPDATE_COC_DIRECTORATE = update shdrc_data."COC_Transaction"  set "ETL_Process_Status" ='M',"Indicator_Value"=? ,"Indicator_Value1"=?,"Updated_On"=? where "Transaction_Key"=?;
COC_INSTITUTION=select  Inst."Institution_Id",Inst."Institution_Name" from shdrc_coc."HUD_Master" Dist JOIN shdrc_coc."Location_Master" Loc ON Loc."HUD_Id" = Dist."HUD_Id" JOIN shdrc_coc."Institution_Master_Dim" Inst ON Loc."Location_Id" = Inst."Location_Id" and Dist."HUD_Type"='COC_Hud' and Dist."HUD_Name"=?  order by Inst."Institution_Name" asc;
#COC_REGION_NAME=select distinct "HUD_Name" from shdrc_coc."Vw_COC_Hierarchy" where "HUD_Name" like '%COC_Hud%'
COC_REGION_NAME=select hud."HUD_Name" from shdrc_coc."HUD_Master" hud LEFT JOIN  (SELECT "User_Roles"."Role_Restrict_Id" "HUD_Id" FROM shdrc_dwh."User_Roles" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" JOIN shdrc_dwh."User_Master" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" AND "User_Roles"."Role_Name" = 'Zones' AND "User_Master"."User_Name" = ?) "User_Restrict_Zone" ON hud."HUD_Id" = "User_Restrict_Zone"."HUD_Id" WHERE  hud."HUD_Type"='COC_Hud' and hud."Active"=1 and ("User_Restrict_Zone"."HUD_Id" IS NOT NULL OR NOT EXISTS ( SELECT "User_Roles"."Role_Restrict_Id" AS "HUD_Id" FROM shdrc_dwh."User_Master" JOIN shdrc_dwh."User_Role_Assoc" ON "User_Role_Assoc"."User_Id" = "User_Master"."User_Id" JOIN shdrc_dwh."User_Roles" ON "User_Role_Assoc"."Role_Id" = "User_Roles"."Role_Id" AND "User_Master"."User_Name" = ?)) order by hud."HUD_Name" asc;
COC_GENERAL_CATEGORY_LIST_BY_FREQUENCY = select distinct "General_Category" from shdrc_dwh."Vw_UDSM_COC" where "Directorate_Id"=? and "Indicator_Frequency" = ? order by "General_Category" asc;
COC_INDICATOR_LIST = select "Indicator_Id","General_Id","Indicator_Name","General_Type","General_Name","General_SubCategory",null,null,null,null,"Is_Character",null from shdrc_dwh."Vw_UDSM_COC" where "Directorate_Id"=?  and "General_Category"=? and "Indicator_Frequency"=? order by "General_SubCategory","Indicator_Name","General_Type","General_Name" asc;
COC_CLASSIFICATION_LIST=select distinct "General_Category" from shdrc_dwh."Vw_UDSM_COC" where "Directorate_Id" =? order by "General_Category" asc;
IS_COC_DEMOGRAPHIC=select distinct "Is_Demography" from shdrc_dwh."Vw_UDSM_COC" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=?;


<!--Health Secretary Dashboard-->
HSDASHBOARD_SEARCHOPTIONS = select "Desc","Paramters","Ind_Name" from shdrc_healthsec_data."Temp_Table" where "Ind_Name"=?;
YEAR_LIST = select "Year" from shdrc_healthsec_data."Year_Master";
MONTH_LIST = select "Month_Name" from shdrc_healthsec_data."Month_Master";
DISTRICT_LIST = select "District_name" from shdrc_healthsec_data."District_Master" where "Active"=1;
INSTITUTION_LIST = select distinct "Inst_Name" from shdrc_healthsec_data."Base_Table";
CHILDINDDETAILSLIST = select "Ind_Name" from shdrc_healthsec_data."Ind_child_master" where "Dash_Name"=?;
FOURPARAMDERIVEDINDDETAILSLIST = select * from shdrc_healthsec_data.percentage_ydim_summary(?,?,?,?,?) order by "bal" desc;
FOURPARAMDIRECTINDDETAILSLIST = select * from shdrc_healthsec_data.child_indicator_ydim_summary(?,?,?,?,?) order by "value" desc;
FOURPARAMCHILDINDDATA = select * from shdrc_healthsec_data.child_four_para_summary(?,?,?,?,?);
ONEPARAMDERIVEDINDDETAILSLIST= select * from shdrc_healthsec_data.percentage_year_summary(?,?) order by "bal" desc; 
ONEPARAMDIRECTINDDETAILSLIST = select * from shdrc_healthsec_data.child_indicator_y_summary(?,?) order by "value" desc;
ONEPARAMCHILDINDDATA = select * from shdrc_healthsec_data.child_indicator_y_summary(?,?);
PROJECTEDVALUES = select to_char(to_timestamp(to_char("Month", '999'), 'MM'), 'Mon'),sum("Projected_Value") from shdrc_healthsec_data."Forecast_Table"  where "Indicator_Name" = ? and "Year" =? and "District" = ?  and "Month" NOT IN(select Extract(month from now()))group by 1;
PROJECTEDALLDISTRICTVALUES = select "District","Projected_Value",to_char(to_timestamp(to_char("Month", '999'), 'MM'), 'Mon')||' - '||"Year" "Month_Year" from shdrc_healthsec_data."Forecast_Table" where "Indicator_Name" = ? and "Year" = ( select extract (year from now() + interval '1 month' ) ) and "Month" IN ( select extract ( month from now() + interval '1 month') )  order by "District"; 
PROJECTEDYEARVALUES = select * from shdrc_healthsec_data.projected_value_year_summary(?,?);
PROJECTEDDISTRICTVALUES = (select to_char(to_timestamp(to_char("Month", '999'), 'MM'), 'Mon')||substring("Year"::text,3,2) "Month_Year" ,"Projected_Value","District","Year","Month" "Month_Num" from shdrc_healthsec_data."Forecast_Table"  where "Indicator_Name" = ? and "Year" = (select Extract(year from now() + interval '1 month' )) and "District" = ? and "Month" >= (select Extract(month from now() + interval '1 month') )) union all (select to_char(to_timestamp(to_char("Month", '999'), 'MM'), 'Mon')||substring("Year"::text,3,2) "Month_Year" ,"Projected_Value","District","Year","Month" "Month_Num"  from shdrc_healthsec_data."Forecast_Table"  where "Indicator_Name" = ? and "Year" = (select Extract(year from now() + interval '1 year' )) and "District" = ? and "Month" < (select Extract(month from now() ) ))order by "Year","Month_Num" ;
YDMTHREEPARAMDERIVEDINDDETAILSLIST = select * from shdrc_healthsec_data.percentage_ymd_summary(?,?,?,?) order by "bal" desc;
YDMTHREEPARAMDIRECTINDDETAILSLIST = select * from shdrc_healthsec_data.child_indicator_ymd_summary(?,?,?,?) order by "value" desc;
YDMTHREEPARAMDIRECTINDDYSFUNCTIONDETAILSLIST= select * from shdrc_healthsec_data.percentage_ymd_dysfunc_summary(?,?,?,?) order by "bal" desc;
YDITHREEPARAMDIRECTINDDYSFUNCTIONDETAILSLIST=select * from shdrc_healthsec_data.percentage_ydi_dysfunc_summary(?,?,?,?) order by "bal" desc;
YDTHREEPARAMDIRECTINDDYSFUNCTIONDETAILSLIST=select * from shdrc_healthsec_data.percentage_yd_dysfunc_summary(?,?,?) order by "bal" desc;
YMDIFOURPARAMDIRECTINDDYSFUNCTIONDETAILSLIST=select * from shdrc_healthsec_data.percentage_ydim_dysfunc_summary(?,?,?,?,?) order by "bal" desc;
YITHREEPARAMDIRECTINDDYSFUNCTIONDETAILSLIST=select * from shdrc_healthsec_data.percentage_yi_dysfunc_summary(?,?,?) order by "bal" desc;
YMTHREEPARAMDIRECTINDDYSFUNCTIONDETAILSLIST=select * from shdrc_healthsec_data.percentage_ym_dysfunc_summary(?,?,?) order by "bal" desc;
YMITHREEPARAMDIRECTINDDYSFUNCTIONDETAILSLIST=select * from shdrc_healthsec_data.percentage_ymi_dysfunc_summary(?,?,?,?) order by "bal" desc;
YDMTHREEPARAMCHILDINDDATA = select * from shdrc_healthsec_data.child_indicator_ymd_summary(?,?,?,?);
YDITHREEPARAMDERIVEDINDDETAILSLIST = select * from shdrc_healthsec_data.percentage_ydi_summary(?,?,?,?) order by "bal" desc;
YDITHREEPARAMDIRECTINDDETAILSLIST = select * from shdrc_healthsec_data.child_indicator_ydi_summary(?,?,?,?) order by "value" desc;
YDITHREEPARAMCHILDINDDATA = select * from shdrc_healthsec_data.child_indicator_ydi_summary(?,?,?,?);
YMITHREEPARAMDERIVEDINDDETAILSLIST = select * from shdrc_healthsec_data.percentage_ymi_summary(?,?,?,?) order by "bal" desc;
YMITHREEPARAMDIRECTINDDETAILSLIST = select * from shdrc_healthsec_data.child_indicator_ymi_summary(?,?,?,?) order by "value" desc;
YMITHREEPARAMCHILDINDDATA = select * from shdrc_healthsec_data.child_indicator_ymi_summary(?,?,?,?);
YMTWOPARAMDERIVEDINDDETAILSLIST = select * from shdrc_healthsec_data.percentage_ym_summary(?,?,?) order by "bal" desc; 

YMTWOPARAMDERIVEDINDDYSFUNCTIODETAILSLIST = select * from shdrc_healthsec_data.percentage_ym_dysfunc_summary(?,?,?) order by "bal" desc;
YITWOPARAMDERIVEDINDDYSFUNCTIODETAILSLIST = select * from shdrc_healthsec_data.percentage_yi_dysfunc_summary(?,?,?) order by "bal" desc;
YDTWOPARAMDERIVEDINDDYSFUNCTIODETAILSLIST = select * from shdrc_healthsec_data.percentage_yd_dysfunc_summary(?,?,?) order by "bal" desc;
ONEPARAMDERIVEDINDDYSFUNCTIODETAILSLIST = select * from shdrc_healthsec_data.percentage_year_dysfunc_summary(?,?) order by "bal" desc;

YMTWOPARAMDIRECTINDDETAILSLIST = select * from shdrc_healthsec_data.child_indicator_ym_summary(?,?,?) order by "value" desc;
YMTWOPARAMCHILDINDDATA = select * from shdrc_healthsec_data.child_indicator_ym_summary(?,?,?);
YDTWOPARAMDERIVEDINDDETAILSLIST = select * from shdrc_healthsec_data.percentage_yd_summary(?,?,?) order by "bal" desc; 
YDTWOPARAMDIRECTINDDETAILSLIST = select * from shdrc_healthsec_data.child_indicator_yd_summary(?,?,?) order by "value" desc;
YDTWOPARAMCHILDINDDATA= select * from shdrc_healthsec_data.child_indicator_yd_summary(?,?,?);
YITWOPARAMDERIVEDINDDETAILSLIST = select * from shdrc_healthsec_data.percentage_yi_summary(?,?,?) order by "bal" desc; 
YITWOPARAMDIRECTINDDETAILSLIST = select * from shdrc_healthsec_data.child_indicator_yi_summary(?,?,?) order by "value" desc;
YITWOPARAMCHILDINDDATA= select * from shdrc_healthsec_data.child_indicator_yi_summary(?,?,?);
DIRECT_PROJECTIONS = select "District", "Value",'( '||upper((to_char(to_timestamp(to_char(substring( min::text, 5 ,2)::integer, '999'), 'MM'), 'Mon')))||' '||substring(min::text , 1, 4 )||' - '||upper((to_char(to_timestamp(to_char(substring( max::text, 5 ,2)::integer, '999'), 'MM'), 'Mon')))||' '||substring(max::text , 1, 4 )||' )' "Month_Year" from (select min(a."Month_Year")  , max(a."Month_Year" ) , case when a."Flag" = 'Yes' then AVG(a."Projected_Value") else SUM(a."Projected_Value")  end as "Value" , a."District" from (select "District" , cast ( "Year"::char(4)||case when "Month" < 10 then ('0'||"Month"::Char) else "Month"::char(2) end  as int )  "Month_Year","Projected_Value" , "Flag"  from shdrc_healthsec_data."Hsec_master" h,shdrc_healthsec_data."Forecast_Table"  f where h."HS_Code" = f."Dash_Id" and h."HS_Description" = ? and "Year" = (select Extract(year from now() + interval '1 month' ))   and "Month" >= (select Extract(month from now() + interval '1 month') )  union all select "District" , cast ( "Year"::char(4)||case when "Month" < 10 then ('0'||"Month"::Char) else "Month"::char(2) end  as int )  "Month_Year","Projected_Value" , "Flag"  from shdrc_healthsec_data."Hsec_master" h,shdrc_healthsec_data."Forecast_Table"  f where h."HS_Code" = f."Dash_Id" and h."HS_Description" = ? and "Year" = (select Extract(year from now() + interval '1 year' ))   and "Month" < (select Extract(month from now() ) ) ) a group by "District" , "Flag" ) a order by "District" ;  
IND_MAX_MONTH_YEAR=select * from shdrc_healthsec_data.max_year_month(?);	


<!-- private sector --!>
PVTSEC_CLASSIFICATION_LIST = select distinct "General_Category" from shdrc_dwh."Vw_UDSM_PVTSEC" where "Directorate_Id" =? order by "General_Category" asc;
UPDATE_PVTSEC_DIRECTORATE = update shdrc_data."PVTSEC_Transaction" set "Indicator_Value"=? ,"Indicator_Value1"=?,"Updated_On"=? where "Transaction_Key"=?;
PVTSEC_GENERAL_CATEGORY_LIST_BY_FREQUENCY = select distinct "General_Category" from shdrc_dwh."Vw_UDSM_PVTSEC" where "Directorate_Id"=? and "Indicator_Frequency" = ? order by "General_Category" asc;
PVTSEC_DAILY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."PVTSEC_Transaction" Trans, shdrc_privatesec."Indicator_Master_Dim" Mast,shdrc_privatesec."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Date"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
PVTSEC_WEEKLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."PVTSEC_Transaction" Trans, shdrc_privatesec."Indicator_Master_Dim" Mast,shdrc_privatesec."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id"  and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Week"=? and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
PVTSEC_MONTHLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."PVTSEC_Transaction" Trans, shdrc_privatesec."Indicator_Master_Dim" Mast,shdrc_privatesec."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Month"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
PVTSEC_QUARTERLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null,Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."PVTSEC_Transaction" Trans, shdrc_privatesec."Indicator_Master_Dim" Mast,shdrc_privatesec."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Id"=? and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Quarter"=? and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name" asc;
PVTSEC_YEARLY_RECORDS = select Trans."Indicator_Id",Gen."General_Id",Mast."Indicator_Name",Gen."General_Type",Gen."General_Name",Gen."General_SubCategory",Trans."Indicator_Value",null, Trans."ETL_Process_Status",Trans."Transaction_Key","Is_Character","Indicator_Value1" from shdrc_data."PVTSEC_Transaction" Trans, shdrc_privatesec."Indicator_Master_Dim" Mast, shdrc_privatesec."General_Master" Gen where  Mast."Indicator_Id" = Trans."Indicator_Id" and Gen."General_Id"=Trans."General_Id" and "District_Id"=? and "Institution_Id"=?  and Mast."Indicator_Category"=? and "Frequency"=?  and "Transaction_Year"=? order by Gen."General_SubCategory",Mast."Indicator_Name",Gen."General_Type", Gen."General_Name" asc;
PVTSEC_INDICATOR_LIST = select "Indicator_Id","General_Id","Indicator_Name","General_Type","General_Name","General_SubCategory",null,"Is_Demography",null,null,"Is_Character",null from shdrc_dwh."Vw_UDSM_PVTSEC" where "Directorate_Id"=? and "General_Category"=? and "Indicator_Frequency"=? and "Is_Demography"=? order by "General_SubCategory","Indicator_Name","General_Type","General_Name" asc;
INSERT_PVTSEC_DIRECTORATE = insert into shdrc_data."PVTSEC_Transaction" ("Directorate_Id","District_Id","Institution_Id","Demographic_Id","General_Id","General_Type","General_Name","General_SubCategory","Indicator_Id","Indicator_Name","Is_Character","Indicator_Value","Indicator_Value1","Frequency","Transaction_Date","Transaction_Week","Transaction_Quarter","Transaction_Month","Transaction_Year","Added_On","Added_By") values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);


<!-- Statistics --!>
INDICATORS_LIST = select "Indicator_Name" from shdrc_dwh."Vw_Indicators_Statistics" where "Directorate_Id"=?; 
INDICATOR_STATISTICS_LIST = select * from shdrc_dwh.aggregate_statistics(?,?);
INDICATOR_DATA_AVAILABILITY =  select * from shdrc_dwh.main_data_avail(?,?) order by "dis";
INDICATOR_MAX_DATA_AVAILABLE = select * from shdrc_dwh.max_year_month_dir(?,?);

# MMR
# MMR_BYDIST = select * from "shdrc_pa".mmr_idm('Total Number of Maternal Death', 'All Districts', 'Apr') order by value desc limit 15;
 MMR_BYDIST = select  a."District",a.death,a.birth,(a.death/a.birth)*100000 as rate from(select "District",sum(CASE WHEN "Indicator_Name" = 'Total Number of Maternal Death' THEN "Value" END) death, sum(CASE WHEN "Indicator_Name" = 'No of Live Births' THEN "Value" END) birth FROM "shdrc_pa".mmr where "Month"=? group by mmr."District")a ,"shdrc_pa".mmr m where "Month"=? GROUP BY a."District",m."Month",death,birth,rate ORDER BY death desc ; 
 MMR_BYDISTHM = (select CONCAT('-',month) as indicator , district,month, value from "shdrc_pa".mmr_idm('Total Number of Maternal Death', 'All Districts',?) order by "value" )  union(select CONCAT('-',month)as indicator , district, month, value from "shdrc_pa".mmr_idm('Total Number of Maternal Death', 'All Districts',?) where "district" in  (select "district" from "shdrc_pa".mmr_idm('Total Number of Maternal Death', 'All Districts',?))   order by "value" )union(select CONCAT('-',month)as indicator , district, month, value from "shdrc_pa".mmr_idm('Total Number of Maternal Death', 'All Districts',?) where "district" in  (select "district" from "shdrc_pa".mmr_idm('Total Number of Maternal Death', 'All Districts',?))   order by "value" );
 MMR_BYINST = select * from "shdrc_pa".mmr_diallm(?, 'All Institutions',?) where indicators = 'Total Number of Maternal Death' order by value desc limit 15;
 MMR_BYINSTHM = (select CONCAT(indicators,'-',month) as indicators , institution,month,value from "shdrc_pa".mmr_diallm(?, 'All Institutions',?) where indicators = 'Total Number of Maternal Death' order by value )union(select CONCAT(indicators,'-',month)as indicators , institution, month, value from "shdrc_pa".mmr_diallm(?, 'All Institutions',?) where indicators = 'Total Number of Maternal Death' and "institution" in  (select "institution" from "shdrc_pa".mmr_diallm(?, 'All Institutions',?) order by "value"))union(select CONCAT(indicators,'-',month)as indicators , institution, month, value from "shdrc_pa".mmr_diallm(?, 'All Institutions',?) where indicators = 'Total Number of Maternal Death' and "institution" in  (select "institution" from "shdrc_pa".mmr_diallm(?, 'All Institutions',?) order by "value"));
 MMR_CHINDAN  = Select indicators, sum(value) from shdrc_pa.mmr_dallim(?, 'All Institutions',?)where district = ? and indicators like '%Moth%' group by indicators ;
 MMR_CHINDANM = Select indicator, sum(value) from shdrc_pa.mmr_im('Number of AN Mothers Registered - Week wise - >28weeks', 'All Months') where month = ? group by indicator union Select indicator, sum(value) from shdrc_pa.mmr_im('Number of AN Mothers tested for GDM', 'All Months') where month =? group by indicator union Select indicator, sum(value) from shdrc_pa.mmr_im('Number of AN Mothers Given Visits', 'All Months') where month = ? group by indicator union Select indicator, sum(value) from shdrc_pa.mmr_im('No of PostNatal Mothers given IFA large tablets', 'All Months') where month = ? group by indicator union Select indicator, sum(value) from shdrc_pa.mmr_im('Number of AN Mothers Registered - Week wise - <12weeks', 'All Months') where month = ? group by indicator union Select indicator, sum(value) from shdrc_pa.mmr_im('Number of AN Mothers Given IFA Large - Prophylactic', 'All Months') where month = ? group by indicator union Select indicator, sum(value) from shdrc_pa.mmr_im('Number of AN Mothers Given IFA Large - Therapeutic', 'All Months') where month = ? group by indicator union  Select indicator, sum(value) from shdrc_pa.mmr_im('Number of AN Mothers Registered - Week wise - 12-28weeks', 'All Months') where month = ? group by indicator union  Select indicator, sum(value) from shdrc_pa.mmr_im('Number of AN Mothers with HB<7grams', 'All Months') where month = ? group by indicator ;
 MMR_CHINDDL = Select indicators, sum(value) from shdrc_pa.mmr_dallim(?, 'All Institutions',?)where district = ? and indicators like '%Occur%' group by indicators ;
 MMR_CHINDDL1 = Select indicators, sum(value) from shdrc_pa.mmr_dallim(?, 'All Institutions',?)where district = ? and indicators like '%Occur%' group by indicators ;
 MMR_CHINDDL2 = Select indicators, sum(value) from shdrc_pa.mmr_dallim(?, 'All Institutions',?)where district = ? and indicators like '%Occur%' group by indicators ;
 MMR_CHINDLD = Select indicators, sum(value) from shdrc_pa.mmr_dallim(?, 'All Institutions',?)where district = ? and indicators in ('Total Number of Maternal Death','Number of High Risk AN Cases Attended PHC','Number of High Risk AN Cases Referred to CEmONC / Higher Medical Institution') group by indicators ;
 MMR_CHINDNC = Select indicators, sum(value) from shdrc_pa.mmr_dallim(?, 'All Institutions',?)where district = ? and indicators in ('Number of Normal Deliveries','Number of Caesarean Deliveries','Number of Assisted Deliveries','No of Live Births') group by indicators ;
 MMR_FCHINDNC = Select * from shdrc_pa.mmr_im('Number of Caesarean Deliveries', ?) union Select * from shdrc_pa.mmr_im('Number of Normal Deliveries',?) union Select * from shdrc_pa.mmr_im('No of Live Births',?) union Select * from shdrc_pa.mmr_im('Number of Assisted Deliveries',?);
 MMR_AXISLINEGT = select indicator,month,to_char(to_date("month", 'Mon'), 'mm') mon, sum(value)  from shdrc_pa.mmr_im('Number of AN Mothers Registered - Age wise >18','All Months')  group by 1,2,3 order by 3;
 MMR_AXISLINELT = select indicator,month,to_char(to_date("month", 'Mon'), 'mm') mon, sum(value)  from shdrc_pa.mmr_im('Number of AN Mothers Registered - Age wise <18','All Months')  group by 1,2,3 order by 3;
 MMR_AXISLINEGT1 = select indicators,month,to_char(to_date("month", 'Mon'), 'mm') mon, sum(value)  from shdrc_pa.mmr_diallm(?, 'All Institutions','All Months') where indicators  like '%Age%' and indicators like '%>%' group by 1,2,3 order by 3;
 MMR_AXISLINELT1 = select indicators,month,to_char(to_date("month", 'Mon'), 'mm') mon, sum(value)  from shdrc_pa.mmr_diallm(?, 'All Institutions','All Months') where indicators  like '%Age%' and indicators like '%<%' group by 1,2,3 order by 3;
 MMR_BYRISK = Select * from shdrc_pa.mmr_im('Total Number of Maternal Death', ?) union Select * from shdrc_pa.mmr_im('Number of High Risk AN Cases Attended PHC',?) union Select * from shdrc_pa.mmr_im('Number of High Risk AN Cases Referred to CEmONC / Higher Medical Institution',?);
 MMR_DEL1 = Select indicator, sum(value) from shdrc_pa.mmr_im('Number of Deliveries Occurred - GH', 'All Months') where month = ? group by Indicator union Select indicator , sum(value) from shdrc_pa.mmr_im('Number of Deliveries Occurred - Domicillary', 'All Months') where month = ? group by Indicator union Select indicator , sum(value) from shdrc_pa.mmr_im('Number of Deliveries Occurred - HSC', 'All Months') where month = ? group by Indicator union Select indicator , sum(value) from shdrc_pa.mmr_im('Number of Deliveries Occurred - PHC', 'All Months') where month = ? group by Indicator union Select indicator , sum(value) from shdrc_pa.mmr_im('Number of Deliveries Occurred - Private Hospital', 'All Months') where month = ? group by Indicator;
 s=?;
 #MMR_DEL2 = Select indicator, sum(value) from shdrc_pa.mmr_im('Number of Deliveries Occurred - GH', 'All Months') where month = 'Mar' group by Indicator union Select indicator , sum(value) from shdrc_pa.mmr_im('Number of Deliveries Occurred - Domicillary', 'All Months') where month = 'Mar' group by Indicator union Select indicator , sum(value) from shdrc_pa.mmr_im('Number of Deliveries Occurred - HSC', 'All Months') where month = 'Mar' group by Indicator union Select indicator , sum(value) from shdrc_pa.mmr_im('Number of Deliveries Occurred - PHC', 'All Months') where month = 'Mar' group by Indicator union Select indicator , sum(value) from shdrc_pa.mmr_im('Number of Deliveries Occurred - Private Hospital', 'All Months') where month = 'Mar' group by Indicator;
 #MMR_DEL3 = Select indicator, sum(value) from shdrc_pa.mmr_im('Number of Deliveries Occurred - GH', 'All Months') where month = 'Apr' group by Indicator union Select indicator , sum(value) from shdrc_pa.mmr_im('Number of Deliveries Occurred - Domicillary', 'All Months') where month = 'Apr' group by Indicator union Select indicator , sum(value) from shdrc_pa.mmr_im('Number of Deliveries Occurred - HSC', 'All Months') where month = 'Apr' group by Indicator union Select indicator , sum(value) from shdrc_pa.mmr_im('Number of Deliveries Occurred - PHC', 'All Months') where month = 'Apr' group by Indicator union Select indicator , sum(value) from shdrc_pa.mmr_im('Number of Deliveries Occurred - Private Hospital', 'All Months') where month = 'Apr' group by Indicator;
 
 
 # IMR
 IMR_BYDIST = select  a."District",a.death,a.birth,(a.death/a.birth)*1000 as rate from(select "District",sum(CASE WHEN "Indicator_Name" = 'Total Number of Infant Death' THEN "Value" END) death, sum(CASE WHEN "Indicator_Name" = 'No of Live Births' THEN "Value" END) birth FROM "shdrc_pa".imr where "Month"=? group by imr."District")a ,"shdrc_pa".imr m where "Month" =? GROUP BY a."District",m."Month",death,birth,rate ORDER BY death desc limit 15 
 IMR_BYDISTHM = (select CONCAT('-',month) as indicator , district,month, value from "shdrc_pa".imr_idm('Total Number of Infant Death', 'All Districts',?) order by "value" )  union(select CONCAT('-',month)as indicator , district, month, value from "shdrc_pa".imr_idm('Total Number of Infant Death', 'All Districts',?) where "district" in  (select "district" from "shdrc_pa".imr_idm('Total Number of Infant Death', 'All Districts',?))   order by "value" )union(select CONCAT('-',month)as indicator , district, month, value from "shdrc_pa".imr_idm('Total Number of Infant Death', 'All Districts',?) where "district" in  (select "district" from "shdrc_pa".imr_idm('Total Number of Infant Death', 'All Districts',?))   order by "value" );
 CHART_HEADER=select "ChartId","Value" from shdrc_pa."CHeader" where "Indicator"=?
 CHART_RANGE=select rmingood, rmaxgood, rminavg, rmaxavg, rminpoor, rmaxpoor from shdrc_pa."CRange" where indicator =?
 IMR_BYINST = select * from "shdrc_pa".imr_diallm(?, 'All Institutions',?) where indicators = 'Total Number of Infant Death' order by value desc limit 15;
 IMR_BYINSTHM = (select CONCAT('-',month) as indicators , institution,month,value from "shdrc_pa".imr_diallm(?, 'All Institutions',?) where indicators = 'Total Number of Infant Death' order by value )union(select CONCAT('-',month)as indicators , institution, month, value from "shdrc_pa".imr_diallm(?, 'All Institutions',?) where indicators = 'Total Number of Infant Death' and "institution" in  (select "institution" from "shdrc_pa".imr_diallm(?, 'All Institutions',?) order by "value"))union(select CONCAT('-',month)as indicators , institution, month, value from "shdrc_pa".imr_diallm(?, 'All Institutions',?) where indicators = 'Total Number of Infant Death' and "institution" in  (select "institution" from "shdrc_pa".imr_diallm(?, 'All Institutions',?) order by "value"));
 IMR_CHINDNC = Select indicators, sum(value) from shdrc_pa.imr_dallim(?, 'All Institutions',?)where district = ? and indicators in ('Total Number of Neo-Natal Deaths','Total Number of Early Neo-Natal Deaths (0-7days)','Total Number of Infant Death','Number of High Risk New Borns Detected') group by indicators ;
 IMR_FCHINDNC = Select * from shdrc_pa.imr_im('Total Number of Neo-Natal Deaths', ?) union Select * from shdrc_pa.imr_im('Total Number of Early Neo-Natal Deaths (0-7days)',?) union Select * from shdrc_pa.imr_im('Total Number of Infant Death',?)union Select * from shdrc_pa.imr_im('Number of High Risk New Borns Detected',?);
 IMR_CHINDLD = Select indicators, sum(value) from shdrc_pa.imr_dallim(?, 'All Institutions',?)where district = ? and indicators in ('Total Number of Infant Death','Number of High Risk New Borns Referred','Number of High Risk New Borns Detected') group by indicators ;
 IMR_BYRISK = Select * from shdrc_pa.imr_im('Total Number of Infant Death', ?) union Select * from shdrc_pa.imr_im('Number of High Risk New Borns Referred',?) union Select * from shdrc_pa.imr_im('Number of High Risk New Borns Detected',?);
 IMR_AXISLINEGT = select indicator,month,to_char(to_date("month", 'Mon'), 'mm') mon, sum(value)  from shdrc_pa.imr_im('Number of High Risk New Borns Detected','All Months')  group by 1,2,3 order by 3;
 IMR_AXISLINELT = select indicator,month,to_char(to_date("month", 'Mon'), 'mm') mon, sum(value)  from shdrc_pa.imr_im('Total Number of Early Neo-Natal Deaths (0-7days)','All Months')  group by 1,2,3 order by 3;
 IMR_AXISLINEGT1 = select indicators,month,to_char(to_date("month", 'Mon'), 'mm') mon, sum(value)  from shdrc_pa.imr_diallm(?, 'All Institutions','All Months') where  indicators ='Number of High Risk New Borns Detected' group by 1,2,3 order by 3;
 IMR_AXISLINELT1 = select indicators,month,to_char(to_date("month", 'Mon'), 'mm') mon, sum(value)  from shdrc_pa.imr_diallm(?, 'All Institutions','All Months') where indicators  = 'Total Number of Early Neo-Natal Deaths (0-7days)' group by 1,2,3 order by 3;
 IMR_CHINDANM = Select indicator, sum(value) from shdrc_pa.imr_im('Total Number of Neo-Natal Deaths', 'All Months') where month = ? group by indicator union Select indicator, sum(value) from shdrc_pa.imr_im('Number of New Borns Breast Fed within 1hour of LSCS Delivery', 'All Months') where month =? group by indicator union Select indicator, sum(value) from shdrc_pa.imr_im('No of Births weighed', 'All Months') where month = ? group by indicator union Select indicator, sum(value) from shdrc_pa.imr_im('Number of Low Birth Weight babies', 'All Months') where month = ? group by indicator ;
 IMR_CHINDAN  = Select indicators, sum(value) from shdrc_pa.imr_dallim(?, 'All Institutions',?)where district = ? and indicators in ('Total Number of Neo-Natal Deaths', 'Number of New Borns Breast Fed within 1hour of LSCS Delivery','No of Births weighed','Number of Low Birth Weight babies') group by indicators ;
 IMR_CHINDDL = Select indicators, sum(value) from shdrc_pa.imr_dallim(?, 'All Institutions',?)where district = ? and indicators like '%Neo%' group by indicators ;
 IMR_CHINDDL1 = Select indicators, sum(value) from shdrc_pa.mmr_dallim(?, 'All Institutions',?)where district = ? and indicators like '%Neo%' group by indicators ;
 IMR_CHINDDL2 = Select indicators, sum(value) from shdrc_pa.mmr_dallim(?, 'All Institutions',?)where district = ? and indicators like '%Neo%' group by indicators ;
 IMR_DEL1 = Select indicator, sum(value) from shdrc_pa.imr_im('Total Number of Neo-Natal Deaths', 'All Months') where month = ? group by Indicator union Select indicator, sum(value) from shdrc_pa.imr_im('Total Number of Early Neo-Natal Deaths (0-7days)', 'All Months') where month = ? group by Indicator;
 
 #CDNCD
 TM_DISTRICTDATANCD = select distinct "District_Name", sum("sum") from shdrc_pa.cdncd where "Month" in('Apr','4') and "Header" = 'NCD' group by 1;
 TM_DISTRICTDATACD = select distinct "District_Name", sum("sum") from shdrc_pa.cdncd where "Month" in('Apr','4') and "Header" = 'CD' group by 1;
 TM_JSON = select distinct "Institution_Name" from shdrc_pa.cdncd where "District_Name"=?;
 TM_JSONI = select distinct "Institution_Name" from shdrc_pa.cdncd where "District_Name"=? and "General_Name" = ?;
 TM_JSONGRANDCHILDCD = select "Institution_Name","General_Name","sum" from shdrc_pa.cdncd where "Header"='CD' and "District_Name"=? and "Month"='Apr';
 TM_JSONGRANDCHILDNCD = select "Institution_Name","General_Name","sum" from shdrc_pa.cdncd where "Header"='NCD' and "District_Name"=? and "Month"='4';
 TM_CD = select distinct "General_Name", sum("sum") as "Incidence Count" from shdrc_pa.cdncd where "Header" = 'CD'  group by 1 order by "Incidence Count" desc limit 15;
 TM_NCD = select distinct "General_Name", sum("sum") as "Incidence Count" from shdrc_pa.cdncd where "Header" = 'NCD'  group by 1 order by "General_Name" ;
 
 TM_CDCLIKD = select distinct "District_Name", sum("sum") as "Incidence Count" from shdrc_pa.cdncd where "Header" = 'CD' and "General_Name" = ? and "Year" = 2015 and "Month" in('Apr','4') group by 1 order by "Incidence Count"; 
 TM_NCDCLIKD = select distinct "District_Name", sum("sum") as "Incidence Count" from shdrc_pa.cdncd where "Header" = 'NCD' and "General_Name" = ? and "Year" = 2015 and "Month" in('Apr','4') group by 1 order by "Incidence Count"; 
 TM_CDCLIKI = select "Institution_Name","General_Name", sum("sum") as "Incidence Count" from shdrc_pa.cdncd where "Header" = 'CD' and "General_Name" = ? and "District_Name" = ? and "Year" = 2015 and "Month" in('Apr','4') group by 1,2 order by "Incidence Count"; 
 TM_NCDCLIKI = select "Institution_Name","General_Name", sum("sum") as "Incidence Count" from shdrc_pa.cdncd where "Header" = 'NCD' and "General_Name" = ? and "District_Name" = ? and "Year" = 2015 and "Month" in('Apr','4') group by 1,2 order by "Incidence Count" ;
 
CD_DISTRICTDATA = select distinct "District_Name",sum("sum") from shdrc_pa.cdncd where "General_Name"=? and "Year"=? and "Month" = ? and "Header" = 'CD' group by 1;
CD_INSTITUTIONDATA = select "Institution_Name","sum" from shdrc_pa.cdncd where "Header"='CD' and "District_Name"=? and "General_Name"=? and "Year"=? and "Month"=?;
NCD_DISTRICTDATA = select distinct "District_Name",sum("sum") from shdrc_pa.cdncd where "General_Name"=? and "Year"=? and "Month"=? and "Header" = 'NCD' group by 1;
NCD_INSTITUTIONDATA = select "Institution_Name","sum" from shdrc_pa.cdncd where "Header"='NCD' and "District_Name"=? and "General_Name"=? and "Year"=? and "Month"=?;

 
 #IND ZONE
 IND_DIST = select "Indicator_Name", "General_Name", "District_Name","Institution_Name", "Time_Year","Time_Month_Name", "Ind_Value" from shdrc_healthsec_data."Disease_Outbreak" where "Indicator_Name" = ? and "Time_Year" = ? and "Time_Month_Name" = ?
 
 #SDGS Dashboard
 DIST_MATERNALDEATH = select * from shdrc_pa."Vw_Dashboard" order by "Indicator_Name";
 MATERNALDEATH_MONTH =  select * from shdrc_pa."Vw_Dashboard_Month" order by "Indicator_Name","Year",to_date("Month",'Mon');
 SDGS_THRESHOLD =  select green_val, amber_val, red_val from shdrc_pa.sdgs_thresh order by sdgs_goal;
 #RAPHAELDATA
 GETRAPHAELDATA = select "Year","Month","District", sum("sum"),sum("projected") from shdrc_pa."NCD_Diagnosed_Districtwise" where "General_Name" = 'Diabetes' and "District"=? Group by 1,2,3;
 GETRAPHAELDATAHT = select "Year","Month","District", sum("sum"),sum("projected") from shdrc_pa."NCD_Diagnosed_Districtwise" where "General_Name" = 'Hypertension' and "District"=? Group by 1,2,3;
 GETDIAB = select distinct "District" from shdrc_pa."NCD_Diagnosed_Districtwise" where "General_Name" = 'Diabetes' limit 15;
 GETHYPT = select distinct "District" from shdrc_pa."NCD_Diagnosed_Districtwise" where "General_Name" = 'Hypertension limit 15';
 
 #IndicatorPage
 GETGENERALCATEGORY = select distinct "Indicator_Category" from shdrc_dms."Indicator_Master_Dim"  where "Ind_Order"  not in (-1,-2) and "Indicator_Category" not in ('Extra') and "Active" =1 group by "Indicator_Category";
 GETINDICATORLIST = select distinct i."Indicator_Id",i."Indicator_Name" from shdrc_dms."Indicator_Master_Dim" i,shdrc_dms."DMS_Fact" f where f."Indicator_Name"=i."Indicator_Name";
 GETSTATELIST = select * from  shdrc_dms.ind_dms_state(?,?,?,?,?,?,?);
 GETDISTRICTLIST select * from shdrc_dms.ind_dms_district(?,?,?,?,?,?,?,?,?);
 GETINSTITUTIONLIST = select * from  shdrc_dms.ind_dms_inst(?,?,?,?,?,?,?,?,?,?);
 GETINDICATORCATEGORY = select distinct "Indicator_Name","General_Category" from shdrc_dms."DMS_Fact" f,shdrc_dms."Indicator_Master_Dim" i,shdrc_dms."General_Master" g where f."Indicator_Id"=i."Indicator_Id" and f."General_Id"=g."General_Id" and "Indicator_Name" like ?;||||||| .r30

 
 #DMS Report Zone
 DMS_REPORT = select * from shdrc_dms.report1_dms_inst(?,?,?,?,?);

 #Predictive Zone
 GETIMRHEATMAP_TOPLEFTDATA = select * from shdrc_dwh.pa_imr_1_1(?,?,?,?,?,?,?); 
 GETIMRHEATMAP_TOPRIGHTDATA = select * from shdrc_dwh.pa_imr_1_2(?,?,?,?,?,?,?);
 GETIMRHEATMAP_BOTTOMLEFTDATA = select * from shdrc_dwh.pa_imr_1_3(?,?,?,?,?,?,?);
 GETIMRHEATMAP_BOTTOMRIGHTDATA = select * from shdrc_dwh.pa_imr_1_4(?,?,?,?,?,?,?);
 #IMR2
 GETIMR2_HEATMAPTOPLEFTDATA = select * from shdrc_dwh.pa_imr_2_1(?,?,?,?);
 GETIMR2_LINETOPRIGHTDATA = select * from shdrc_dwh.pa_imr_2_2(?,?,?,?);
 GETIMR2_HEATMAPBOTTOMDATA = select * from shdrc_dwh.pa_imr_2_3(?,?,?,?);
 
 #DOB
 GETDISEASELIST = select distinct "General_Name" from shdrc_pa."DMS_Disease_Outbreak_Inst_DiseaseWise";
 GETDOB_HEATMAPTOPLEFTDATA = select * from shdrc_dwh.pa_dob_1(?,?,?,?,?,?,?,?);
 GETDOB_HEATMAPTOPRIGHTDATA = select * from shdrc_dwh.pa_dob_2(?,?,?,?,?,?,?,?);
 GETDOB_LINEBOTTOMLEFTDATA = select * from shdrc_dwh.pa_dob_3(?,?,?,?,?,?,?,?);
 GETDOB_HEATMAPBOTTTOMRIGHTDATA = select * from shdrc_dwh.pa_dob_4(?,?,?,?,?,?,?,?);
 GETDISTRICTLIST = select distinct "District_Name" from shdrc_dwh."District_Master" where "State_Name"='Tamil Nadu' and "District_Name" <> 'NA' order by "District_Name";
 
 #HOB
 GETHOB_LINETOPLEFTDATA = select * from shdrc_dwh.pa_hob_1(?,?,?,?,?,?);
 GETHOB_BARTOPRIGHTDATA = select * from shdrc_dwh.pa_hob_2(?,?,?,?,?,?);
 GETHOB_BOTTOMDATA = select * from shdrc_dwh.pa_hob_3(?,?,?,?,?,?);
 #BBSI
 GETBBSI_BARTOPLEFTDATA=select * from shdrc_dwh.pa_blood_2_1(?,?,?,?,?);
 GETBBSI_BARTOPRIGHTDATA=select * from shdrc_dwh.pa_blood_2_2(?,?,?,?,?);
 GETBBSI_BOTTOMLEFTDATA=select * from shdrc_dwh.pa_blood_2_3(?,?,?,?,?);
 #BBS
 GETBBS_TOPLEFTDATA = select * from shdrc_dwh.pa_blood_1_1(?,?,?,?,?,?);
 GETBBS_TOPRIGHTDATA = select * from shdrc_dwh.pa_blood_1_2(?,?,?,?,?,?);
 GETBBS_BOTTOMLEFTDATA = select * from shdrc_dwh.pa_blood_1_3(?,?,?,?,?,?);
 GETBBS_BOTTOMRIGHTDATA = select * from shdrc_dwh.pa_blood_1_4(?,?,?,?,?,?);
 GETINDCATEGORYLIST = select distinct "Indicator_Category" from shdrc_pa."Bloodbank_Indicator_Master";
 #FIP
 GETFIP_TOPLEFTDATA = select * from shdrc_dwh.pa_immu_1_1(?,?,?,?);
 GETFIP_TOPRIGHTDATA = select * from shdrc_dwh.pa_immu_1_2(?,?,?,?);
 GETFIP_BOTTOMLEFTDATA = select * from shdrc_dwh.pa_immu_1_3(?,?,?,?);
 GETFIP_BOTTOMRIGHTDATA = select * from shdrc_dwh.pa_immu_1_4(?,?,?,?);
 GETYEARLIST = select distinct "Year" from shdrc_pa."Immunization" order by "Year";
 #CDD
 GETFILETYPELIST = select distinct case when "Ref_No_3"='P' then 'Preauth' when "Ref_No_3"='C' then 'Claims' when "Ref_No_3"='D' then 'DC' when "Ref_No_3"='F' then 'Finance' end as "File_Type" from shdrc_pa."CMCHIS_Status" order by "File_Type" desc;
 GETREASONLIST = select "Reason" from (select distinct "Reason" , case when "Ref_No_3"='P' then 'Preauth' when "Ref_No_3"='C' then 'Claims' when "Ref_No_3"='D' then 'DC' when "Ref_No_3"='F' then 'Finance' end as "File_Type" from shdrc_pa."CMCHIS_Reason")a where "File_Type"=?;
 GETCDD_TOPLEFTDATA = select * from shdrc_dwh.pa_cmchis_denied_1(?,?,?,?,?,?,?,?);
 GETCDD_TOPRIGHTDATA = select * from shdrc_dwh.pa_cmchis_denied_2(?,?,?,?,?,?,?,?);
 GETCDD_BOTTOMLEFTDATA = select * from shdrc_dwh.pa_cmchis_denied_3(?,?,?,?,?,?,?,?);
 GETCDD_BOTTOMRIGHTDATA = select * from shdrc_dwh.pa_cmchis_denied_4(?,?,?,?,?,?,?,?);
 #CSP
 GETCSP_TOPLEFTDATA = select * from shdrc_dwh.pa_cmchis_service_1(?,?,?,?,?);
 GETCSP_TOPRIGHTDATA = select * from shdrc_dwh.pa_cmchis_service_2(?,?,?,?,?);
 GETCSP_BOTTOMLEFTDATA = select * from shdrc_dwh.pa_cmchis_service_3(?,?,?,?,?);
 GETCSP_BOTTOMRIGHTDATA = select * from shdrc_dwh.pa_cmchis_service_4(?,?,?,?,?);
 #CPP
 GETCPP_TOPLEFTDATA=select * from shdrc_dwh.pa_cmchis_procedure_1(?,?,?,?,?);
 GETCPP_TOPRIGHTDATA=select * from shdrc_dwh.pa_cmchis_procedure_2(?,?,?,?,?);
 GETCPP_BOTTOMLEFTDATA=select * from shdrc_dwh.pa_cmchis_procedure_3(?,?,?,?,?);
 GETCPP_BOTTOMRIGHTDATA=select * from shdrc_dwh.pa_cmchis_procedure_4(?,?,?,?,?);
 GETSPECIALITYLIST=select distinct "General_Category" from shdrc_cmchis."General_Master" where "General_Category"<>'' order by "General_Category";
 #CNP
 GETCNP_TOPLEFTDATA=select * from shdrc_dwh.pa_cmchis_nmi_1(?,?,?,?,?,?);
 GETCNP_TOPRIGHTDATA=select * from shdrc_dwh.pa_cmchis_nmi_2(?,?,?,?,?,?);
 GETCNP_BOTTOMLEFTDATA=select * from shdrc_dwh.pa_cmchis_nmi_3(?,?,?,?,?,?);
 GETCNP_BOTTOMRIGHTDATA=select * from shdrc_dwh.pa_cmchis_nmi_4(?,?,?,?,?,?);
 #MMR INSIDES
 GETMMRI_TOPLEFTDATA=select * from shdrc_dwh.pa_MMR_1_1(?,?,?,?);
 GETMMRI_TOPRIGHTDATA=select * from shdrc_dwh.pa_MMR_1_2(?,?,?);
 GETMMRI_BOTTOMLEFTDATA=select * from shdrc_dwh.pa_MMR_1_3(?,?,?);
 #MMR OPERATIONAL
 GETREASONABLEINDICATORLIST=select distinct "Indicator_Name" from shdrc_pa."MMR_Child_Districtwise_Norm";
 GETMMRO_TOPLEFTDATA=select * from shdrc_dwh.pa_mmr_2_1(?,?,?,?);
 GETMMRO_TOPRIGHTDATA=select * from shdrc_dwh.pa_mmr_2_2(?,?,?,?,?);
 GETMMRO_BOTTOMLEFTDATA=select * from shdrc_dwh.pa_mmr_2_3(?,?,?,?,?);
 GETMMRO_BOTTOMRIGHTDATA=select * from shdrc_dwh.pa_mmr_2_4(?,?);
 #MEASLES
 GETMEASLES_TOPLEFTDATA=select * from shdrc_dwh.pa_measles_1(?,?,?);
 GETMEASLES_TOPRIGHTDATA=select * from shdrc_dwh.pa_measles_2(?,?,?);
 GETMEASLES_BOTTOMLEFTDATA=select * from shdrc_dwh.pa_measles_3(?,?,?);
 GETMEASLES_BOTTOMRIGHTDATA=select * from shdrc_dwh.pa_measles_4(?,?,?);
 
 
 
 #USER Mnagement
 Directorate_Master_Dim= select "Directorate_Id", "Directorate_Name" from shdrc_dwh."Directorate_Master_Dim";
 SAVE_USER_DETAILS = insert into shdrc_dwh."User_Master"("User_Id","User_Name","Ufname","Ulname","Upass","Email","Mobile","Tier","Added_On","Directorate_Id","Designation") values((select max("User_Id")+1 from shdrc_dwh."User_Master"),?,?,?,?,?,?,?,?,?,?);
 GET_USER_DETAILS = select "Tier_Id" from shdrc_dwh."User_Tier_Master" where "OG_Id"=? and "Tier_Cd"=?;
GET_LDAPORGNAME_DETAILS = select "Org_Name" from shdrc_dwh."User_Org_Group" JOIN shdrc_dwh."Directorate_Master_Dim" on "Org_Desc" ="Directorate_Name" where shdrc_dwh."Directorate_Master_Dim"."Directorate_Id"=?;
GET_USER_DETAILS_ByOGId = select "OG_Id" from shdrc_dwh."User_Org_Group" JOIN shdrc_dwh."Directorate_Master_Dim" on "Org_Desc" ="Directorate_Name" where shdrc_dwh."Directorate_Master_Dim"."Directorate_Id"=?;
USER_MANAGEMENT_LIST = select "User_Name","Ufname","Ulname","Mobile","Email","Designation","User_Id" from shdrc_dwh."User_Master" where "Directorate_Id"=?;
USER_MANAGEMENT_LIST_BY_USERID=select "User_Name","Ufname","Ulname","Upass","Email","Mobile","Designation",usr."Directorate_Id","Tier","Tier_Cd","User_Id","Directorate_Name" from shdrc_dwh."User_Master" usr join shdrc_dwh."User_Tier_Master" tier on usr."Tier"=tier."Tier_Id" join shdrc_dwh."Directorate_Master_Dim" dir on usr."Directorate_Id"=dir."Directorate_Id"where "User_Id"=?;
Update_USER_VALUES= update shdrc_dwh."User_Master" set "Ufname"=?,"Ulname"=?,"Email"=?,"Mobile"=?,"Designation"=?,"Updated_On"=? where "User_Id"=?;
Update_CHANGE_PWD_VALUES= update shdrc_dwh."User_Master" set "Upass"=?,"Updated_On"=? where "User_Id"=?;